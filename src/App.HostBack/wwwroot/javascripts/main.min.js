var MainTemplates=function(){var e,o,n,a,u=this,s=(document.getElementsByTagName("html")[0],$(document.body)),r=!1,t=$(window),l=$("#wrapper"),c=$("#content-btn")||!1,d=$("#header-wrapper")||!1,h=$("#aside-wrapper")||!1,p=$("#aside")||!1,f=$("#aside-menu")||!1,m=$("#aside-switcher")||!1,v=null,g=null,b=0,C=!1,k=$("#dialog-wrapper")||!1,w=!1,S=$("#modal"),x=$("#modal .modal-container"),y=$("[data-modal]"),F=$("#modal-close"),D=$("#header-main-menu")||!1,A=$("#header-account-menu")||!1,P=$("#footer-wrapper")||!1,T=500,I=!1,N=!1,L=($("#content-wrapper"),$("#content")||!1),E=!1,O=!1,M={windowWidth:0,setCurrDate:!1,showTooltip:!0,saveUser:!0},H="";/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)),this.isScreenDeskTop=function(){return!!$("#is-screen-desktop").is(":visible")},this.isScreenTabletBig=function(){return!!$("#is-screen-tablet-big").is(":visible")},this.isScreenTablet=function(){return!!$("#is-screen-tablet").is(":visible")},this.isScreenMobileBig=function(){return!!$("#is-screen-mobile-big").is(":visible")},this.isScreenMobile=function(){return!!$("#is-screen-mobile").is(":visible")},moment.locale("uk"),this.sortArrObjByMethod=function(e,n){return e.sort(function(e,t){var a=e[n],i=t[n];return i=+i,(a=+a)!=a||i!=i?e[n]-t[n]:a-i})},this.addAttr=function(e,t,a){e.attr(t,a)},this.addData=function(e,t,a){e.data(t,a)},this.calculateWindowHeight=function(){return $(window).height()},this.calculateWindowWidth=function(){return $(window).width()},this.clearElEventListeners=function(e){$(e).off(),$(e).find("*").each(function(){$(this).off()})},this.generateId=function(){return"_"+Math.random().toString(36).substr(2,9)},this.isElValueEmpty=function(e){return""==$.trim($(e).val())},this.isStringEmpty=function(e){return""==$.trim(e)},this.returnTagName=function(e){return $(e).prop("tagName").toLowerCase()},this.toggleActiveClass=function(e){$(e).hasClass("active")?u.removeActiveClass(e):u.addActiveClass(e)},this.addNotActiveClass=function(e){$(e).addClass("not-active")},this.removeNotActiveClass=function(e){$(e).removeClass("not-active")},this.addActiveClass=function(e){$(e).addClass("active")},this.addNotDisabledClass=function(e){$(e).addClass("disabled")},this.removeNotDisabledClass=function(e){$(e).removeClass("disabled")},this.addDisabledClass=function(e){$(e).addClass("disabled")},this.removeActiveClass=function(e){$(e).removeClass("active")},this.toggleOpenClass=function(e){$(e).hasClass("open")?u.removeOpenClass(e):u.addOpenClass(e)},this.addOpenClass=function(e){$(e).addClass("open")},this.removeOpenClass=function(e){$(e).removeClass("open")},this.addTestClass=function(e){$(e).addClass("test")},this.removeTestClass=function(e){$(e).removeClass("test")},this.listColumnSwitch=function(e){$(e).on("click",function(){$(l).toggleClass("wrapper-column wrapper-list"),u.updateNiceScroll()})},this.addEmptyNotEmptyClass=function(e){e.is(":visible")&&(u.isElValueEmpty(e)?($(e).removeClass("not-empty"),$(e).addClass("empty")):($(e).removeClass("empty"),$(e).addClass("not-empty")),$(e).closest(".datepicker-group")&&u.addDatePickerGroupEmptyNotEmptyClass(e))},this.addDatePickerGroupEmptyNotEmptyClass=function(e){var t=$(e).closest(".datepicker-group"),a=$(t).find(".input ,.select"),i=!1;$(a).each(function(){($(this).is(":visible")||"input"!=u.returnTagName)&&(u.isElValueEmpty($(this))||(i=!0))}),i?($(t).removeClass("empty"),$(t).addClass("not-empty")):($(t).removeClass("not-empty"),$(t).addClass("empty"))},$("*").is(".btn-column-list")&&$(".btn-column-list").each(function(){u.listColumnSwitch($(this))}),l&&$(l).find(".btn-column-list").each(function(){l.hasClass("wrapper-list")&&$(this).removeClass("icon-list").addClass("icon-columns"),l.hasClass("wrapper-column")&&$(this).removeClass("icon-columns").addClass("icon-list"),$(this).on("click",function(){l.hasClass("wrapper-list")&&$(this).removeClass("icon-list").addClass("icon-columns"),l.hasClass("wrapper-column")&&$(this).removeClass("icon-columns").addClass("icon-list")})}),this.updateNiceScroll=function(){s.getNiceScroll().resize()},this.createSelectScrollBar=function(e){g=new PerfectScrollbar(e,{wheelSpeed:.5,minScrollbarLength:20,maxScrollbarLength:60})},this.destroySelectScrollBar=function(){g&&(g.destroy(),g=null)},this.scrollTop=function(){var e=$("#scroll-top");$(window).scroll(function(){$(window).scrollTop()>o/4?$(e).removeClass("hidden"):$(e).addClass("hidden")}),$(e).on("click",function(){$("html, body").animate({scrollTop:0},600),$(this).addClass("hidden")})},this.showHideHeader=function(){t.scrollTop()>d.outerHeight()?(d.addClass("top-fixed"),p.addClass("top-fixed"),m.addClass("top-fixed"),d.find(".menu-horizontal, .menu-vertical, .menu-side").each(function(){u.closeAllOpenLi($(this))}),d.on("mouseover mouseenter",u.showHeader),d.on("mouseleave",u.hideHeader),setTimeout(function(){d.css("transition-duration",".35s")},T)):(d.removeClass("top-fixed"),p.removeClass("top-fixed"),m.removeClass("top-fixed"),setTimeout(function(){d.css("transition-duration","")},T))},this.showHeader=function(){p.hasClass("top-fixed")&&(d.css("top","0"),h.css("top",d.outerHeight()),m.css("height",d.outerHeight()))},this.hideHeader=function(){d.css("top",""),h.css("top",""),m.css("height",""),d.hasClass("top-fixed")&&d.find(".menu-horizontal, .menu-vertical, .menu-side").each(function(){u.closeAllOpenLi($(this))})},this.checkCollapsedBody=function(){$(s).hasClass("collapsed")&&(r=!0)},this.createAsideScrollBar=function(){r||p&&(v=new PerfectScrollbar(p.get(0),{wheelSpeed:.1,minScrollbarLength:20,maxScrollbarLength:60}))},this.destroyAsideScrollBar=function(){v&&(v.destroy(),v=null)},this.toggleCollapseBody=function(){s.hasClass("collapsed")?u.unCollapseBody():u.collapseBody()},this.collapseBody=function(){u.saveToStorage("collapsed",!0),r=!0,u.destroyAsideScrollBar(),s.addClass("collapsed"),u.closeAllOpenLi(f)},this.unCollapseBody=function(){u.saveToStorage("collapsed",!1),r=!1,u.createAsideScrollBar(),s.removeClass("collapsed"),u.onLoadActiveLi(f)},this.showHideCollapsedArrow=function(){var e,t=f.children(),a=t.length,i=0,n=2*parseInt($("#aside-arrow-top").css("height")),r=$("header").outerHeight();if(a){for(var s=0;s<a;s++)e=t[s],i+=$(e).outerHeight();o<i+n+r?$(p).addClass("show-arrow"):$(p).removeClass("show-arrow")}},this.manageAside=function(){r?this.showHideCollapsedArrow():u.createAsideScrollBar()},$(m).on("click",function(){u.toggleCollapseBody()}),this.showHideFooter=function(){u.returnScrollHeight()-u.returnWindowHeight()-t.scrollTop()<$(P).outerHeight()/12?u.addActiveClass(P):u.removeActiveClass(P)},this.menuNavigation=function(e,t,a,i){u.addNavChevrons(e,i),t&&u.onBodyClickHideNav(e),$(e).on("click keypress",function(e){var t,a=$(e.target);"a"!=u.returnTagName(a)&&0==a.closest("a").length&&((t=a.closest("li")).hasClass("open")?u.closeAllOpenLi(t):(i&&u.closeAllOpenLi(t.parent().find(".open")),u.openOpenLi(t)))}),a&&$(e).children("li").children(".aside-menu-li-inner").on("mouseleave",function(){r&&u.removeOpenClass(e.find(".open"))})},this.addNavChevrons=function(e,t){for(var a=$(e).find("div.menu-item").closest("li"),i=0,n=a.length;i<n;i++)$(a[i]).find("ul").length&&(t?$(a[i]).find("div.menu-item").addClass("menu-item-chevron"):$(a[i]).find("div.menu-item").addClass("menu-item-nested"))},this.onBodyClickHideNav=function(r){s.on("click",function(e){var t=$(e.target),a=t.parents();a.push(t);for(var i=0,n=a.length;i<n;i++)if($(a[i]).is(r))return;u.closeAllOpenLi(r)})},this.closeAllOpenLi=function(e){e.find(".open").each(function(){u.removeOpenClass($(this))}),u.removeOpenClass(e),e.find("ul.menu-side").length&&u.hideSideMenu(e.find("ul.menu-side"))},this.openOpenLi=function(e){e.children().children("ul.menu-side").length?(u.addOpenClass(e),u.toggleSideMenu(e)):e.children().children("ul").length&&(u.addOpenClass(e),u.toggleOpenClass(e.children().children("ul")))},this.onLoadActiveLi=function(e){$(e).find(".active").length&&$(e).find(".active").parentsUntil(e).each(function(){$(this).parent(e).length&&"li"==u.returnTagName($(this))&&u.addActiveClass($(this)),r||"ul"!=u.returnTagName($(this))&&"li"!=u.returnTagName($(this))||u.addOpenClass($(this))})},this.hideSideMenu=function(e){u.removeOpenClass(e),setTimeout(function(){e.css({opacity:"","max-width":"0"})},T)},this.toggleSideMenu=function(e){var t=e.children().children("ul.menu-side");$(e).hasClass("open")?(t.css({opacity:"1","max-width":""}),u.addOpenClass(t)):u.hideRightMenu(t)},f&&(u.menuNavigation(f,!1,!0,!1),t.on("load",function(){u.onLoadActiveLi(f)})),$(D)&&u.menuNavigation(D,!0,!1,!0),$(A)&&u.menuNavigation(A,!0,!1,!0),this.getBreadCrumbsList=function(e){var a;if(function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));{if(!t||"undefined"===decodeURIComponent(t[1]))return;a=JSON.parse(decodeURIComponent(document.cookie.split("=")[1]))}}(e),void 0!==a&&a){var t=a,n=$("#bread-crumbs"),r="";if(null!==t&&0<t.length)for(i=0;t.length>i;i++){var s=t[i],o=s.Name,l=s.Link;0===i?r+='<li><a class="homepage-link" href="'+l+'" title="'+o+'"><i class="icon-sm icon-home"></i></a></li>':i===t.length-1?r+="<li><span>"+o+"</span></li>":r+='<li><a href="'+l+'">'+o+"</a></li>"}$(location).attr("origin")+"/"==$(location).attr("href")&&$("#bread-crumbs").hide(),n.html(r)}},this.formatTextDate=function(e){var t="";void 0!==$(e).data("date")?(t=u.convertDate($(e).data("date")),void 0!==$(e).data("date-end")&&(t=t+" - "+u.convertDate($(e).data("date-end")))):void 0!==$(e).data("date-end")&&(t=u.convertDate($(e).data("date-end"))),$(e).text(t)},this.createJsGridDatePicker=function(e,t){$(e).datepicker({dateFormat:"dd.mm.yy",firstDay:1}),t&&$(e).datepicker({setDate:u.convertDate(t),defaultDate:u.convertDate(t)})},this.convertDate=function(e){e=$.trim(e);var t=new Date(e),a=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();return i<10&&(i="0"+i),n<10&&(n="0"+n),"Invalid Date"==t?e:n+"."+i+"."+a},this.convertDateForMoment=function(e){var t=e.split("."),a=t[0],i=t[1];return[t[2],i,a]},this.returnDateToIsoString=function(e){var t=e.split("."),a=+t[0],i=+t[1]-1,n=+t[2];return new Date(n,i,a).toISOString()},this.normalizeDate=function(e){return/^\s*(3[01]|[12][0-9]|0?[1-9])\.(1[012]|0?[1-9])\.((?:19|20)\d{2})\s*$/g.test(e)?e:u.convertDate(e)},this.checkDatepickerPair=function(e){var t,a,i,n,r,s,o;$(e).closest(".dates-group")&&(t=$(e).closest(".dates-group"),n=$(t).find('.data-range-result[name$="_From"]'),r=$(t).find('.data-range-result[name$="_To"]'),o=$(n).val(),s=$(r).val(),i=$(t).find('[id$="_To"]'),a=$(t).find('[id$="_From"]'),$(i).datepicker("option","minDate",new Date(o)),$(a).datepicker("option","maxDate",new Date(s)))},this.createDatePicker=function(e){$(e).val()&&$(e).val(u.normalizeDate($(e).val()));var t=$(e).attr("name");$(e).attr("name",""),$(e).parent().append('<input class = "data-range-result" type = "hidden" name = "'+t+'"/>'),$(e).datepicker({showButtonPanel:!0,closeText:"Закрити",prevText:"&#x3c;Поп",nextText:"Наст&#x3e;",currentText:"Сьогодні",monthNames:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],monthNamesShort:["Січ","Лют","Бер","Квіт","Трав","Черв","Лип","Серп","Вер","Жовт","Лист","Груд"],dayNames:["неділя","понеділок","вівторок","среда","четвер","п'ятница","субота"],dayNamesShort:["нд","пн","вт","ср","чт","пт","сб"],dayNamesMin:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],weekHeader:"Ти",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",defaultDate:new Date,input:function(){},beforeShow:function(e,t){O=!0,$(this).hasClass("datepicker-input-select")&&$(this).parent().addClass("select-hidden"),$(this).closest(".input-col-2").addClass("dates-group")},onClose:function(e,t){$(this).hasClass("datepicker-input-select")&&u.isElValueEmpty($(this))&&$(this).parent().removeClass("select-hidden"),$.when(u.setDataPickerHiddenValue($(this))).done(u.checkDatepickerPair($(this))).done(u.addEmptyNotEmptyClass($(this))),O=!1}}),u.setDataPickerHiddenValue(e,!0),$(".datepicker-input-select").on("focus",function(){u.closeAllSelect(s)})},this.setDataPickerHiddenValue=function(e,t){var a,i,n=$(e).closest(".datepicker-group"),r=$(n).find(".hasDatepicker"),s=$(n).find(".select-range-before")||!1,o=$(n).find(".select-range-after")||!1,l=$(n).find(".select-range-input")||!1;if(t)a=i="",$(r).val()&&(i=$(r).val(),u.isStringEmpty(i)||(emptyDate=!0,i=u.returnDateToIsoString(i),a=s.length||o.length?i+"&"+i:i));else{i=$(r).val();var c=u.validateDate(r);if(c)return void u.showNotValidMsg(e,c);u.isStringEmpty(i)?s.length||o.length?(u.isElValueEmpty(s)&&u.isElValueEmpty(o)||(a=(new Date).toISOString()),s.length&&o.length?a=u.subtractDate(a,$(s).val())+"&"+u.addDate(a,$(o).val()):s.length?a=u.subtractDate(a,$(s).val())+"&"+a:o.length&&(a=a+"&"+u.addDate(a,$(o).val()))):a=l.length?u.isElValueEmpty(l)?"":u.subtractDate((new Date).toISOString(),$(l).val()):"":(a=u.returnDateToIsoString(i),(s.length||o.length)&&(s.length&&o.length?a=u.subtractDate(a,$(s).val())+"&"+u.addDate(a,$(o).val()):s.length?a=u.subtractDate(a,$(s).val())+"&"+a:o.length&&(a=a+"&"+u.addDate(a,$(o).val()))),l.length&&(u.removeAttrSelected(l),$(n).removeClass("select-hidden")))}$(n).find(".data-range-result").val(a)},this.subtractDate=function(e,t){switch(t){case"day":return moment(e).subtract(1,"days").toISOString();case"3day":return moment(e).subtract(3,"days").toISOString();case"week":return moment(e).subtract(1,"week").toISOString();case"month":return moment(e).subtract(1,"month").toISOString();case"quarter":return moment(e).subtract(3,"month").toISOString();case"halfYear":return moment(e).subtract(6,"month").toISOString();case"year":return moment(e).subtract(1,"year").toISOString();default:return e}},this.addDate=function(e,t){switch(t){case"day":return moment(e).add(1,"days").toISOString();case"3day":return moment(e).add(3,"days").toISOString();case"week":return moment(e).add(1,"week").toISOString();case"month":return moment(e).add(1,"month").toISOString();case"quarter":return moment(e).add(3,"month").toISOString();case"halfYear":return moment(e).add(6,"month").toISOString();case"year":return moment(e).add(1,"year").toISOString();default:return e}},this.setDatePickerInputSelectValue=function(e){$(e).parent().find(".hasDatepicker").val(""),u.setDataPickerHiddenValue($(this))},this.createDatePickerInputSelect=function(e){var t=$(e).closest(".datepicker-group");$.when($(e).after(u.createDatepickerSelect(!1,!1,!0))).done(function(){$(t).addClass("datepicker-input-select-wrapper"),u.createDatePicker(e),$(t).find(".select-range-input").on("change",function(){$(t).find(".hasDatepicker").val(""),u.setDataPickerHiddenValue($(this))})})},this.createDateRangeBefore=function(e){var t=$(e).closest(".datepicker-group");$.when($(e).before(u.createDatepickerSelect(!0,!1,!1))).done(function(){u.createDatePicker(e),$(t).addClass("date-range-before-wrapper"),$(t).find(".select-range-before").on("change",function(){u.setDataPickerHiddenValue($(this))})})},this.createDateRangeAfter=function(e){var t=$(e).closest(".datepicker-group");$.when($(e).after(u.createDatepickerSelect(!1,!0,!1))).done(function(){$(t).addClass("date-range-after-wrapper"),u.createDatePicker(e),$(t).find(".select-range-after").on("change",function(){u.setDataPickerHiddenValue($(this))})})},this.createDateRangeBeforeAfter=function(e){var t=$(e).closest(".datepicker-group");$.when($(e).before(u.createDatepickerSelect(!0,!1,!1)).after(u.createDatepickerSelect(!1,!0,!1))).done(function(){$(t).addClass("date-range-before-after-wrapper"),u.createDatePicker(e),$(t).find(".select-range-before").on("change",function(){u.setDataPickerHiddenValue($(this))}),$(t).find(".select-range-after").on("change",function(){u.setDataPickerHiddenValue($(this))})})},this.createDatepickerSelect=function(e,t,a){var i="select";return e&&(i+=" select-range-before"),t&&(i+=" select-range-after"),a&&(i+=" select-range-input"),'<select class = "'+i+'"><option value = ""></option><option value = "day">1 день</option><option value = "3day">3 дні</option><option value = "week">тиждень</option><option value = "month">місяц</option><option value = "quarter">3 місяці</option><option value = "halfYear">6 місяців</option><option value = "year">рік</option></select>'},this.findFormatDateParagraph=function(e){$(e).find(".format-date").each(function(){u.formatTextDate($(this))})},this.closeAllSelect=function(){$(".select-gap").each(function(){u.closeDefinedSelect($(this))})},this.closeDefinedSelect=function(e){$(e).hasClass("select-gap")||(e=$(e).parent().find(".select-gap")),e.removeClass("on");var t=e.closest(".select-group-inner"),a=e.next(".select-list");""!=$.trim(t.find("select").val())||""!=$.trim(t.find(".select-gap").text())?t.addClass("not-empty"):t.removeClass("not-empty"),$(t).closest(".datepicker-group")&&u.addDatePickerGroupEmptyNotEmptyClass(t),t.removeClass("on"),a.slideUp(b),u.destroySelectScrollBar(),a.removeAttr("id"),C=!1},this.selectWrap=function(e){if(!$(e).is(":hidden")&&$(e).is(":visible")){e.hide(),e.wrap('<div class="select-group-inner"></div>'),$("<span>",{class:"select-group-bar"}).insertAfter(e);var t=e.next(".select-group-bar");$("<div>",{class:"select-gap"}).insertAfter(t);var a=t.next(".select-gap");$("<ul>",{class:"select-list"}).insertAfter(a),u.createSelectList(e)}},this.createSelectList=function(i){var e=i.find("option"),t=i.closest(".select-group-inner"),a=e.length,n=!1,r=t.find(".select-gap"),s=r.next(".select-list"),o=e.filter(":selected");if(r.attr("tabindex","0"),!o.length)return r.text(""),t.addClass("select-readonly"),void t.removeClass("not-empty");if(r.text(e.eq(o.index()).text()),t.removeClass("select-readonly"),u.isStringEmpty($(r).text())||$(t).addClass("not-empty"),$(i).is("[readonly]"))$(t).addClass("select-readonly");else{$(t).closest(".datepicker-group")&&u.addDatePickerGroupEmptyNotEmptyClass(t),b=i.css("transition-duration"),i.hasClass("select-warning")&&(n=!0);for(var l=0;l<a;l++)$("<li>",{class:"select-item",html:$("<span>",{text:e.eq(l).text()})}).attr("data-value",e.eq(l).val()).attr("data-disabled",e.eq(l).attr("disabled")).appendTo(s);var c=s.find("li");s.slideUp(0),r.on("click keydown",function(){$(this).hasClass("on")?u.closeDefinedSelect($(this)):(C&&u.closeAllSelect(),$(this).addClass("on"),t.addClass("on"),C=!0,s.slideDown(b),u.createSelectScrollBar(s.get(0)),c.off().on("click keydown",function(e){var t,a;n&&i.val()?(t=e,a=$(this),u.createDialog(t,"<p>При зміні сутності, введенні права доступу для полей сутності видаляться автоматично</p>",function(){return d(a)},function(){return u.closeAllSelect()})):d($(this))}))})}function d(e){var t=e.data("value");$(i).val(t).attr("selected","selected"),r.text(e.find("span").text()),u.closeDefinedSelect(r),$(i).trigger("change")}},this.removeAttrSelected=function(e){$(e).val(""),$(e).find("option").removeAttr("selected"),e.closest(".select-group-inner").find(".select-gap").text(""),u.closeDefinedSelect(e)},this.updateSelectList=function(e){u.clearSelectGroupInner(e),u.createSelectList(e)},this.clearSelectGroupInner=function(e){var t=e.closest(".select-group-inner");u.clearElEventListeners(t),$(t).find(".select-list").html("")},this.setSelectValue=function(e,t){$(e).find("option").each(function(){$(this).removeAttr("selected")}),$(e).find("[value = "+t+"]").attr("selected","selected"),u.updateSelectList(e)},this.returnSelectedOptionText=function(e){for(var t,a=$(e).find("option"),i=$(e).val(),n=0;n<a.length;n++)if(t=a[n],$(t).val()==i)return $(t).text()},this.createAccordion=function(e){var a=$.extend({speed:300,accordionItemSelector:".accordion-item",accordionItemHeaderSelector:".accordion-item-header",accordionItemContentSelector:".accordion-item-content"},e),t=$(this);$(document).on("click",a.accordionItemSelector,function(e){var t=$(this);t.hasClass("active")?(t.find(a.accordionItemContentSelector).slideUp(a.speed),t.removeClass("active")):(t.find(a.accordionItemContentSelector).slideDown(a.speed),t.addClass("active")),setTimeout(function(){u.updateNiceScroll(t)},300)}),$(document).on("click",a.accordionItemHeaderSelector+" a",function(e){e.stopPropagation()}),$(document).on("click",a.accordionItemContentSelector,function(e){e.stopPropagation()}),$(document).keypress(function(e){13==e.which&&$(e.target).parents(t)&&$(e.target).trigger("click")})},$(".accordion").is(":not(.not-active)")&&$(".accordion").each(function(){u.createAccordion($(".accordion"))}),this.createDialog=function(e,t,a,i){var n=$("#dialog-inner");function r(){$("#dialog-confirm").off().on("click",function(){u.hideDialogWrapper(),a&&a()})}function s(){$("#dialog-refuse").off().on("click",function(){u.hideDialogWrapper(),i()})}w=!0,a&&i?(n.find(".btn-holder").html("<button id='dialog-refuse' class='btn btn-danger btn-outline'>Відмовитися</button><button id='dialog-confirm' class='btn btn-secondary btn-outline'>Підтвердити</button>"),r(),s()):i?(n.find(".btn-holder").html("<button id='dialog-refuse' class='btn btn-danger btn-outline'>OK</button>"),s()):(a?n.find(".btn-holder").html("<button id='dialog-confirm' class='btn btn-secondary btn-outline'>Підтвердити</button>"):n.find(".btn-holder").html("<button id='dialog-confirm' class='btn btn-secondary btn-outline'>OK</button>"),r()),$("#dialog-text").html(t),u.showDialogWrapper()},this.showDialogWrapper=function(){u.addOpenClass(k),u.addActiveClass(k)},this.hideDialogWrapper=function(){u.removeActiveClass(k),setTimeout(function(){$("#dialog-confirm").off(),$("#dialog-refuse").off(),$("#dialog-text").html(""),$("#dialog-btn").html(""),u.removeOpenClass(k),w=!1},T)},this.selectDataTemplate=function(e,t){switch(e.type){case"dataGroup":var a,i="";void 0!==e.labelName&&(i="<label> "+e.labelName+" </label>"),a='<div class="input-col-2">'+i+'<div class="input-col-2-inner">';for(var n=0;n<e.children.length;n++)a+=u.selectDataTemplate(e.children[n],t);return a+="</div></div>";case"select":return u.createSelectTemplate(e);case"datepicker":return u.createDatePickerTemplate(e,t);case"hidden":return u.createHiddenInputTemplate(e);case"datepickerBefore":return u.createDatePickerBeforeTemplate(e);case"datepickerAfter":return u.createDatePickerAfterTemplate(e);case"datepickerBeforeAfter":return u.createDatepickerBeforeAfterTemplate(e);case"checkbox":return u.createCheckboxTemplate(e);case"checkbox-tree":case"checkbox-tree-child":return u.createCheckboxTreeTemplate(e);case"text":default:return u.createTextInputTemplate(e)}},this.createTextInputTemplate=function(e){var t="";return void 0!==e.validate&&(t=u.createValidateAttr(e.validate)),'<div class="input-group"><input class = "input" type="text" autocomplete="off" name = "'+e.name+'"'+t+'/><span class="input-group-bar"></span><label>'+e.labelName+'</label><span class="js-validation"></span></div>'},this.createHiddenInputTemplate=function(e){var t;return t=void 0!==e.value?e.value:"",'<input type="hidden" name = "'+e.name+'" value = "'+t+'"/>'},this.createCheckboxTemplate=function(e){var t="";return e.value&&(t=" checked"),'<div class="checkbox-group"><div class="checkbox-group-inner"><input id = "'+e.id+'" class="checkbox" type="checkbox" name="'+e.name+'"'+t+'/><label for="'+e.id+'">'+e.labelName+'</label></div><span class="checkbox-group-bar"></span></div>'},this.createCheckboxTreeTemplate=function(e){var t="";return e.value&&(t=" checked"),'<li class="tree-group"><span>'+e.Code+'</span><input id = "'+e.Code+'" class="" type="checkbox" name="'+e.Name+'"'+t+'/><label for="'+e.Code+'">'+e.Name+"</label></li>"},this.createDatePickerTemplate=function(e,t){var a="";t&&(a="-input-select");var i="";return void 0!==e.validate&&(i=u.createValidateAttr(e.validate)),'<div class="datepicker-group input-group"><input class = "input datepicker'+a+'" type="text"id="'+e.name+'"name="'+e.name+'"'+i+'/><span class="input-group-bar"></span><label for="'+e.name+'">'+e.labelName+'</label><span class="js-validation"></span></div>'},this.createDatePickerAfterTemplate=function(e){var t="";return void 0!==e.validate&&(t=u.createValidateAttr(e.validate)),'<div class="datepicker-group input-group"><input class = "input date-range-after" type="text" name="'+e.name+'"'+t+'/><span class="input-group-bar"></span><label>'+e.labelName+'</label><span class="js-validation"></span></div>'},this.createDatePickerBeforeTemplate=function(e){var t="";return void 0!==e.validate&&(t=u.createValidateAttr(e.validate)),'<div class="datepicker-group input-group"><input class = "input date-range-before" type="text" name="'+e.name+'"'+t+'/><span class="input-group-bar"></span><label>'+e.labelName+'</label><span class="js-validation"></span></div>'},this.createDatepickerBeforeAfterTemplate=function(e){var t="";return void 0!==e.validate&&(t=u.createValidateAttr(e.validate)),'<div class="datepicker-group input-group"><input class = "input date-range-before-after" type="text" name="'+e.name+'"'+t+'/><span class="input-group-bar"></span><label>'+e.labelName+'</label><span class="js-validation"></span></div>'},this.createSelectTemplate=function(e){var t="",a="";void 0!==e.validate&&(t=u.createValidateAttr(e.validate)),void 0===e.onchangeUrl&&""==$.trim(e.onchangeUrl)||(a=' onchange-url = "'+e.onchangeUrl+'"');var i,n='<option value = ""></option>';if("string"==typeof e.selectOptions&&(e.selectOptions=JSON.parse(e.selectOptions)),e.selectOptions&&void 0!==e.selectOptions)for(var r=0,s=e.selectOptions.length;r<s;r++)n+="<option ",(i=e.selectOptions[r]).Disabled&&(n+="disabled "),i.Selected&&(n+="selected "),n+='value="'+i.Value+'">'+i.Text+"</option>";return'<div class="select-group"><select name="'+e.name+'" class="select"'+a+t+">"+n+"</select><label>"+e.labelName+'</label><span class="js-validation"></span></div>'},this.activateFormControls=function(e){$(e).find(".datepicker")&&$(e).find(".datepicker").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.createDatePicker($(this)))}),$(e).find(".datepicker-input-select")&&$(e).find(".datepicker-input-select").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.createDatePickerInputSelect($(this)))}),$(e).find(".date-range-before")&&$(e).find(".date-range-before").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.createDateRangeBefore($(this)))}),$(e).find(".date-range-before-after")&&$(e).find(".date-range-before-after").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.createDateRangeBeforeAfter($(this)))}),$(e).find(".date-range-after")&&$(e).find(".date-range-after").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.createDateRangeAfter($(this)))}),$(e).find(".select")&&$(e).find(".select").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.selectWrap($(this)))}),$(e).find(".input")&&$(e).find(".input").each(function(){$(this).hasClass("active")||(u.addActiveClass($(this)),u.initInputAfterLoad($(this)))})};var B=function(e){var t=this;this.form=e,this.filters=[],this.filled=!1,this.formWrapper=$(t.form).closest(".content-search"),this.formHolder=$(t.form).find(".content-search-form-holder"),this.formPreset=$(t.form).find(".content-search-form-preset"),this.formSwitcher=$(t.formWrapper).find(".content-search-switcher"),this.formPresetSwitcher=$(t.formWrapper).find(".content-preset-switcher"),this.mainInput=$(t.formWrapper).find(".content-search-main-input")||!1,this.mainText=$(t.formWrapper).find(".content-search-main-text")||!1,this.shownFilters=[],this.hasFields=!1,this.hasPresetFilters=!1,this.dirty=!1,this.submitBtn=$(t.formHolder).find(".search-form-btn-submit"),this.saveFilterBtn=$(t.formHolder).find(".search-form-btn-save-filter"),this.clearFormBtn=$(t.formHolder).find(".search-form-btn-clean"),this.savePresetFilterForm=$(t.formHolder).find(".preset-filter-wrapper"),this.savePresetFilterNameInput=$(t.savePresetFilterForm).find(".preset-filter-name-input"),this.savePresetFilterDefaultCheckbox=$(t.savePresetFilterForm).find(".preset-filter-default-checkbox"),this.savePresetFilterSaveBtn=$(t.savePresetFilterForm).find(".preset-filter-save"),this.savePresetFilterCancelBtn=$(t.savePresetFilterForm).find(".preset-filter-cancel"),this.savePresetFilterFormOpen=!1,this.parametersFilterHolder=$(t.formWrapper).find(".content-filter-parameters"),this.clearAllFiltersBtn=$(t.parametersFilterHolder).find(".content-filter-parameters-clear-all")};this.createContentSearchForm=function(e,t){if(e&&void 0!==e){var a=new B($('form[name="'+e.formConfig.formName+'"]'));if(a.mainInputConfig=e.mainInputConfig||!1,a.submitFunction=t||!1,a.presetFiltersUrl=e.presetFiltersUrl||!1,a.formMethod=e.formConfig.formMethod||"post",a.controls=[],e.formConfig.formDataAjaxUpdate&&u.addAttr(a.form,"data-ajax-update",e.formConfig.formDataAjaxUpdate),u.addAttr(a.form,"data-ajax-complete","mt.searchFormCompleteFunction($(this))"),a.presetFiltersUrl&&a.presetFiltersUrl.actionName&&a.presetFiltersUrl.controllerName?(a.hasPresetFilters=!0,u.getPresetFilters(a,!0)):u.submitMainInput(a),a.mainInputConfig?u.createMainInput(a):u.createMainText(a),a.controls){!function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a}(a.presetFiltersUrl)?(a.controls=e.formConfig.controls.controlsConfig,u.activateSearchForm(a)):($(a.formHolder).addClass("has-presettings"),$.when(u.getConstrolsConfig(a)).done(function(){0<a.controls.length?u.activateSearchForm(a):(a.controls=e.formConfig.controls.controlsConfig,$.when(a.controls=e.formConfig.controls.controlsConfig).done(u.activateSearchForm(a)))}))}$(a.formPresetSwitcher).on("click",function(){u.toggleSearchFormPresetFilters(a)}),u.addActiveClass(a.formWrapper)}},this.getConstrolsConfig=function(t){var e,a,i=t.presetFiltersUrl.controllerName,n=n=i+"-"+t.presetFiltersUrl.actionName;return e=i+"/GenerateInputConfig",a={journalName:n},$.ajax({type:"post",url:e,data:a,success:function(e){e=JSON.parse(e),t.controls=e},error:function(e){console.log("error",e)}})},this.getDefaultControls=function(e,t){e.controls=t,$.when(e.controls=t).done(u.activateSearchForm(e))},this.activateSearchForm=function(e){u.addActiveClass(e.formSwitcher),u.addActiveClass(e.formWrapper),$(e.formSwitcher).on("click",function(){e.filled?u.toggleSearchFormHolder(e):(u.showLoader(e.formHolder),$.when($(e.formHolder).find("ul").html(u.createFormTemplate(e))).done(u.hideLoader(e.formHolder)).done(u.toggleSearchFormHolder(e)).done(u.watchDirtyForm(e),u.activateFormControls($(e.formHolder).find("ul")),u.createSearchFormBtnsClickListeners(e),e.filled=!0,setTimeout(function(){u.updateNiceScroll()},T)))})},this.createMainText=function(e){var t=e.mainInputText||"Для формування звіту виберіть параметри";$(e.mainText).text(t)},this.createMainInput=function(e){var t=e.mainInput,a=e.mainInputConfig;a.labelName?u.addAttr(t,"placeholder",a.labelName):u.addAttr(t,"placeholder","Пошук"),a.type?u.addAttr(t,"type",a.type):u.addAttr(t,"type","text"),t.val(""),u.manageMainInput(e)},this.manageMainInput=function(t){$(t.mainInput).keydown(function(e){13===e.keyCode&&(e.preventDefault(),t.filled&&u.clearSearchForm(t,!0),u.submitMainInput(t))}),$(t.formWrapper).find(".content-search-submit-main-input").each(function(){$(this).on("click",function(){t.filled&&u.clearSearchForm(t,!0),u.submitMainInput(t)})})},this.submitMainInput=function(e){var t=u.prepareSearchQueryData([{name:e.mainInputConfig.mainInputLookUp[0],value:$(e.mainInput).val()}]);u.isElValueEmpty(e.mainInput)?e.shownFilters=[]:e.shownFilters=[{name:e.mainInputConfig.mainInputLookUp[0],shownName:e.mainInputConfig.labelName,value:$(e.mainInput).val(),shownValue:$(e.mainInput).val()}],u.ajaxSubmitSearchForm(e,t)},this.clearMainInput=function(e){$(e.mainInput).val("")},this.prepareParametersFilter=function(e){e.shownFilters.length?($(e.clearAllFiltersBtn).on("click",function(){u.clearAllSearchFormFilters(e)}),$.when($(e.parametersFilterHolder).find("ul").html(u.createPresetFilters(e.shownFilters))).done($(e.parametersFilterHolder).find(".content-filter-parameters-item span").each(function(){u.setRemoveFilterListener($(this),e.shownFilters,e)})),u.addOpenClass(e.parametersFilterHolder),u.addActiveClass(e.parametersFilterHolder)):($(e.parametersFilterHolder).find("ul").html(""),u.removeOpenClass(e.parametersFilterHolder),u.removeActiveClass(e.parametersFilterHolder))},this.createPresetFilters=function(e){for(var t,a="",i=0;i<e.length;i++)a+='<li class = "content-filter-parameters-item"> <p>'+(t=e[i]).shownName+": "+t.shownValue+'</p> <span data-remove = "'+t.name+'"><i class="icon-xxs icon-close"></i></span>';return a},this.setRemoveFilterListener=function(t,a,i){var n;$(t).on("click",function(){n=u.findObjIndexInArr(a,"name",$(t).data("remove")),a.splice(n,1);var e=u.prepareSearchQueryData(a);u.ajaxSubmitSearchForm(i,e)})},this.clearAllSearchFormFilters=function(e){e.shownFilters=[];var t=u.prepareSearchQueryData(e.shownFilters);u.ajaxSubmitSearchForm(e,t)},this.createFormTemplate=function(e){for(var t,a=e.controls,i=a.length,n="",r=0;r<i;r++)t=a[r],e.hasFields=!0,n+='<li class="content-search-form-inner">'+u.selectDataTemplate(t,!0)+"</li>";return n},this.addActiveClassToFormSwitcher=function(e){e.hasFields&&u.addActiveClass(e.formSwitcher)},this.toggleSearchFormHolder=function(e){$(e.formSwitcher).hasClass("open")?u.closeSearchFormHolder(e):u.openSearchFormHolder(e)},this.openSearchFormHolder=function(e){$(e.form).find("input").each(function(){u.addEmptyNotEmptyClass($(this))}),u.addOpenClass(e.formHolder),u.addOpenClass($(e.formHolder).parent()),u.addOpenClass(e.formSwitcher),setTimeout(function(){I=e},T)},this.closeSearchFormHolder=function(e){e||(e=I),u.removeOpenClass(e.formHolder),u.removeOpenClass($(e.formHolder).parent()),u.removeOpenClass(e.formSwitcher),I=!1,$(e.formHolder).find(".js-validation").each(function(){u.removeActiveClass($(this)),setTimeout(function(){$(this).text("")},T)}),u.closeNewPresetFilterForm(e)},this.closeSearchFormHolderAndPresetFilters=function(){I&&u.closeSearchFormHolder(),N&&u.closePresetFiltersForm()},this.toggleSearchFormPresetFilters=function(e){$(e.formPresetSwitcher).hasClass("open")?u.closePresetFiltersForm(e):u.openPresetFiltersForm(e)},this.openPresetFiltersForm=function(e){u.getPresetFilters(e,!1),u.addOpenClass(e.formPresetSwitcher),u.addActiveClass($(e.formPreset).parent()),u.addOpenClass(e.presetWrapper),u.createSelectScrollBar($(e.formPreset).find("ul").get(0)),setTimeout(function(){N=e},T)},this.closePresetFiltersForm=function(e){e||(e=N),u.removeOpenClass(e.formPresetSwitcher),u.removeActiveClass($(e.formPreset).parent()),u.removeOpenClass(e.formPreset),u.destroySelectScrollBar(),N=!1,e.presetSettingActive&&u.deActivatePresetFiltersSetting(e)},this.submitSearchForm=function(e){if(u.validateForm($(e.formHolder).find("ul"))){u.showLoader($($(e.form).data("ajax-update"))),u.clearMainInput(e),u.closeSearchFormHolder(e),u.clearPaging(e.form),e.shownFilters=u.findDataForPresetFilters(e);var t=u.prepareSearchQueryData(e.shownFilters);u.ajaxSubmitSearchForm(e,t)}},this.submitDefaultFilter=function(e){u.showLoader($($(e.form).data("ajax-update")));for(var t=e.filters,a=!1,i=0;i<t.length;i++)if(t[i].default){a=t[i];break}if(a){e.shownFilters=a.fields;var n=u.prepareSearchQueryData(a.fields);u.ajaxSubmitSearchForm(e,n)}else u.submitMainInput(e)},this.findDataForPresetFilters=function(e){var n=[],t=$(e.formHolder).find(".select-group"),a=$(e.formHolder).find(".checkbox-group"),i=$(e.formHolder).find(".input-group");return $(t).each(function(){var e,t;$(this).parent().is(".preset-filter-inner")||(e=$(this),t=$(e).find("select"),u.isElValueEmpty(t)||n.push({name:$(t).attr("name"),shownName:$(t).closest(".select-group").find("label").text(),type:"select",value:$(t).val(),shownValue:u.returnSelectedOptionText(t)}))}),$(a).each(function(){var e,t;$(this).parent().is(".preset-filter-inner")||(e=$(this),t=$(e).find("input:checkbox"),$(t).prop("checked")&&n.push({name:$(t).attr("name"),shownName:$(t).parent().find("label").text(),type:"checkbox",value:!0,shownValue:"Так"}))}),$(i).each(function(){var e,t,a,i;$(this).parent().is(".preset-filter-inner")||($(this).hasClass("datepicker-group")?(a=$(this),i=$(a).find(".data-range-result"),u.isElValueEmpty(i)||(u.isElValueEmpty($(a).find(".select-range-input"))?u.isElValueEmpty($(a).find(".hasDatepicker"))||n.push({name:$(i).attr("name"),shownName:$(i).parent().find("label").text(),type:"datePickerInput",value:$(i).val(),shownValue:$(a).find(".hasDatepicker").val()}):n.push({name:$(i).attr("name"),shownName:$(i).parent().find("label").text(),type:"datePickerSelect",value:$(a).find(".select-range-input").val(),shownValue:u.returnSelectedOptionText($(a).find(".select-range-input"))+" тому"}))):(e=$(this),t=$(e).find("input"),u.isElValueEmpty(t)||n.push({name:$(t).attr("name"),shownName:$(t).parent().find("label").text(),type:"input",value:$(t).val(),shownValue:$(t).val()})))}),!!n.length&&n},this.submitPresetFilter=function(e,t){var a=u.findObjIndexInArr(e.filters,"filterId",$(t).attr("id")),i=u.prepareSearchQueryData(e.filters[a].fields);u.showLoader($($(e.form).data("ajax-update"))),e.shownFilters=e.filters[a].fields,u.closePresetFiltersForm(e),u.ajaxSubmitSearchForm(e,i)},this.prepareSearchQueryData=function(e){for(var t={"X-Requested-With":"XMLHttpRequest"},a=0;a<e.length;a++)"datePickerSelect"==e[a].type?t[e[a].name]=u.subtractDate((new Date).toISOString(),e[a].value):t[e[a].name]=e[a].value;return t},this.ajaxSubmitSearchForm=function(t,e){u.showLoader();var a=t.formMethod,i=$(t.form).attr("action"),n=$(t.form).data("ajax-update");u.clearPaging(t.form),$.ajax({type:a,url:i,data:{paramList:e,options:null},success:function(e){$(n).html(e),u.searchFormCompleteFunction(t.form),u.prepareParametersFilter(t)},error:function(e){u.createDialog(!1,"<p>Виникла помилка при виведенні данних пошуку</p>")}})},this.searchFormCompleteFunction=function(e){var t=$($(e).data("ajax-update"));$.when(u.initMask(t)).done(u.findFormatDateParagraph(t)).done(u.findGrids(t)).done(u.createPaging(t)).done(u.setDeleteContentListItem(t),u.updateNiceScroll(),u.createCheckboxLabel(t),u.setToolTipsForChild(t),u.hideLoader(t))},this.addSearchFormEnterListener=function(t){$(document).keydown(function(e){13===e.keyCode&&I&&(e.preventDefault(),u.submitSearchForm(t))})},this.setDefaultPresetFilter=function(e,t){var a="",i=!1,n=u.findObjIndexInArr(e.filters,"filterId",$(t).attr("id"));$(t).find("input:checkbox").prop("checked")&&(a=$(t).find("input:checkbox").attr("id"),i=!0);for(var r=0;r<e.filters.length;r++)e.filters[r].default=!1;$(e.presetWrapper).find(".checkbox").each(function(){$(this).prop("checked",!1)}),i&&($("#"+a).prop("checked",!0),e.filters[n].default=!0),u.updatePresetFilters(e,!0)},this.deletePresetFilter=function(e,t,a){var i=u.findObjIndexInArr(t.filters,"filterId",$(a).attr("id"));u.createDialog(e,"<p>Підтвердіть видалення фільтру</p>",function(){t.filters.splice(i,1),u.clearElEventListeners(a),$(a).remove(),u.reOrderPresetFilters(t),u.updatePresetFilters(t)},function(){return})},this.savePresetFilter=function(e){var t=!0;if(u.validateForm(e.savePresetFilterForm)){for(var a=$.trim($(e.savePresetFilterNameInput).val()),i=0;i<e.filters.length;i++)if($.trim(e.filters[i].name)==a){t=!1;u.createDialog(!1,"<p>Фільтр з таким ім'ям вже збережений</p>",n);break}function n(){$(e.savePresetFilterNameInput).focus()}if(!t)return;var r=u.findDataForPresetFilters(e);if(r){var s={};s.name=$(e.savePresetFilterNameInput).val(),s.default=$(e.savePresetFilterDefaultCheckbox).prop("checked"),s.order=e.filters.length,s.fields=r;var o="filter"+u.generateId();if(s.filterId=o,s.default)for(var l=0;l<e.filters.length;l++)e.filters[l].default=!1;e.filters.push(s),u.updatePresetFilters(e)}else u.createDialog(!1,"Виберіть параметри фільтру");u.closeNewPresetFilterForm(e)}},this.createSortablePresetFilters=function(e){},this.destroySortablePresetFilters=function(e){},this.openNewPresetFilterForm=function(t){t.savePresetFilterFormOpen=!0,u.addActiveClass($(t.savePresetFilterForm)),$(t.savePresetFilterNameInput).focus(),$(t.savePresetFilterCancelBtn).on("click",function(e){e.preventDefault(),u.closeNewPresetFilterForm(t)}),$(t.savePresetFilterSaveBtn).on("click",function(e){e.preventDefault(),u.savePresetFilter(t)})},this.closeNewPresetFilterForm=function(e){e.savePresetFilterFormOpen&&($(e.savePresetFilterNameInput).val(""),u.removeActiveClass($(e.savePresetFilterForm)),e.savePresetFilterFormOpen=!1)},this.reOrderPresetFilters=function(e){for(var t,a,i=$(e.presetWrapper).find(".preset-btn"),n=0;n<i.length;n++)t=i[n],a=u.findObjIndexInArr(e.filters,"filterId",$(t).attr("id")),e.filters[a].order=n;e.filters&&e.filters.length||u.closePresetFiltersForm(e)},this.findObjIndexInArr=function(e,t,a){for(var i=$.trim(a),n=0;n<e.length;n++){var r=e[n];if($.trim(r[t])===i)return n}},this.sortPresetFiltersByOrder=function(e){return u.sortArrObjByMethod(e,"order")},this.getPresetFilters=function(t,a){var e,i,n=t.presetFiltersUrl.controllerName,r=r=n+"-"+t.presetFiltersUrl.actionName;e=n+"/GetPresettings",i={journalName:r},$.ajax({type:"POST",url:e,data:i,success:function(e){"string"==typeof e&&e.length&&(H=e,e=JSON.parse(e),t.filters=u.sortPresetFiltersByOrder(e.filters),a&&u.submitDefaultFilter(t),t.presetWrapper=$(t.form).find(".content-search-form-preset")[0],u.buildPresetFilters(t)),t.filters.length<=0&&u.submitSearchForm(t)},error:function(e){u.createDialog(!1,"<p>Виникла помилка при генерації збережених фільтрів</p><p>Обновіть сторінку</p>"),console.error(e)}})},this.setPresetFilters=function(e,t,a,i){var n,r,s=e.presetFiltersUrl.controllerName,o=o=s+"-"+e.presetFiltersUrl.actionName;t&&(n=s+"/SetPresettings",r={journalName:o,presettingsJson:t}),$.ajax({type:"POST",url:n,data:r,success:function(e){return e.setSuccess?a():i()},error:function(e){return console.error(e),i()}})},this.updatePresetFilters=function(a,e){e||(e=!1);var t=!1;if(a.filtersChanging){u.createDialog(!1,"<p>Система зайнята.</p><p>Зачекайте та спробуйте ще раз.</p>")}else{a.presetSettingActive&&(t=!0,u.deActivatePresetFiltersSetting(a),u.addActiveClass(a.presetWrapper)),e||u.showLoader(a.presetWrapper),a.filtersChanging=!0;var i={};i.filters=a.filters,i=JSON.stringify(i),u.setPresetFilters(a,i,function(){u.reBuildPresetFilters(a),t&&u.activatePresetFiltersSetting(a);H=i},function(){var e=JSON.parse(H);a.filters=u.sortPresetFiltersByOrder(e.filters);var t=setInterval(function(){if(!w){u.reBuildPresetFilters(a),u.createDialog(!1,"<p>Виникла помилка при збереженні фільтра</p>",!1,n),clearInterval(t)}},66)})}function n(){}},this.buildPresetFilters=function(e){var t="";if(u.removeActiveClass(e.formPresetSwitcher),e.filters.length){u.sortArrObjByMethod(e.filters,"order"),u.addActiveClass(e.formPresetSwitcher);for(var a=0;a<e.filters.length;a++)t+=u.createFilter(e.filters[a]);$.when($(e.presetWrapper).find("ul").html(t)).done(u.createCheckboxLabel(e.presetWrapper),u.setPresetFiltersClickListener(e))}},this.createFilter=function(e){var t="";return void 0!==e.default&&e.default&&(t=" checked "),'<li class="btn btn-outline preset-btn" id="'+e.filterId+'" <div class="checkbox-group-inner"><input type="checkbox" '+t+"/></div><p>"+e.name+'</p><span class = "remove-preset-btn icon icon-sm icon-remove" data-title = "Видалити фільтр"></span></>'},this.setPresetFiltersClickListener=function(a){a.presetSettingActive=!1,$(a.presetWrapper).find(".preset-filters-settings").on("click",function(){u.activatePresetFiltersSetting(a)}),$(a.presetWrapper).find(".preset-filters-settings-cancel").on("click",function(){u.deActivatePresetFiltersSetting(a)}),$(a.presetWrapper).find(".preset-btn").each(function(){var t=$(this);$(t).find("span").on("click",function(e){e.stopPropagation(),u.deletePresetFilter(e,a,t)}),$(t).find(".checkbox-group-inner").on("click",function(e){e.stopPropagation()}),$(t).find("label").on("click",function(e){a.presetSettingActive||e.preventDefault()}),$(t).find("input").on("change",function(){u.setDefaultPresetFilter(a,t)}),$(t).on("click",function(){a.presetSettingActive||$.when(u.submitPresetFilter(a,t)).done(u.closePresetFiltersForm(a))})})},this.reBuildPresetFilters=function(e){u.clearElEventListeners(e.presetWrapper),u.hideLoader(e.presetWrapper),$(e.presetWrapper).find("ul").html(""),e.filtersChanging=!1,u.buildPresetFilters(e)},this.activatePresetFilterBtn=function(e){e.dirty?u.removeNotDisabledClass(e.saveFilterBtn):u.addNotDisabledClass(e.saveFilterBtn)},this.activatePresetFiltersSetting=function(e){e.presetSettingActive=!0,u.createSortablePresetFilters(e),u.addActiveClass(e.presetWrapper)},this.deActivatePresetFiltersSetting=function(e){e.presetSettingActive=!1,u.removeActiveClass(e.presetWrapper),u.destroySortablePresetFilters(e)},this.watchDirtyForm=function(r){function t(){for(var e=!1,t=$(r.formHolder).find("select, input, .select-group, .input-group, .select-group-inner, .datepicker-input-select, .datepicker-input-select-wrapper"),a=0;a<t.length;a++){var i=t[a],n=$(i).hasClass("not-empty");1==n?e=!0:1==n&&(e=!1)}return e}$(r.formHolder).on("click focus blur change",function(){r.dirty=t(),u.activatePresetFilterBtn(r);var e=s.find("#ui-datepicker-div, .ui-datepicker-calendar, .ui-state-default");$(e).on("blur focus change click",function(){r.dirty=t(),u.activatePresetFilterBtn(r)})})},this.createSearchFormBtnsClickListeners=function(t){$(t.clearFormBtn).on("click",function(){u.clearSearchForm(t),$(".hasDatepicker").datepicker("option","minDate",null),$(".hasDatepicker").datepicker("option","maxDate",null)}),$(t.saveFilterBtn).on("click",function(){t.dirty&&function e(){t.savePresetFilterFormOpen?setTimeout(e,66):u.openNewPresetFilterForm(t)}()}),t.submitFunction?$(t.submitBtn).on("click",function(){u.validateForm(t.form)&&(u.showLoader($(t.form.data("ajax-update"))),t.submitFunction(t))}):$(t.submitBtn).on("click",function(e){e.preventDefault(),u.submitSearchForm(t)})},this.clearSearchForm=function(e,t){$(e.formHolder).find("input").each(function(){$(this).val(""),u.addEmptyNotEmptyClass($(this))}),$(e.formHolder).find("select").each(function(){u.removeAttrSelected($(this))}),t||e.mainInput&&$(e.mainInput).val("")},this.manageContentTabs=function(){var e=L.find(".content-item");1<e.length&&u.createContentItemSwitcher(e),u.manageRightBtnMenu(),u.addOpenClass($(e)[0])},this.manageRightBtnMenu=function(){$(c).find("*").is(":visible")?$(L).addClass("has-btn"):$(L).removeClass("has-btn")},this.createContentItemSwitcher=function(e){$(L).addClass("has-switcher");for(var t,a,i=$("#content-switcher"),n=0,r=e.length;n<r;n++)a=e[n],t=$(i).hasClass("content-switcher-row")?$('<a class = "btn btn-tab"  data-tooltipright = "1" data-title = "'+$(a).find("h2").text()+'" id = "'+$(a).find("h2").attr("id")+'"></a>').appendTo($(i)):$('<a class = "btn btn-square btn-fill btn-secondary" data-tooltipright = "1" data-title = "'+$(a).find("h2").text()+'"></a>').appendTo($(i)),$(a).find(".content-item-header i").clone().appendTo(t),$(a).find(".content-item-header i").remove(),u.contentItemAddEventListener(e,t,a);var s=$(".content-switcher-row").children(),o="";for(n=0;s.length>n;n++)o+="64px ";$(".content-switcher-row").css("grid-template-columns",o),u.addActiveClass($(i).find("a").eq(0))},this.contentItemAddEventListener=function(e,t,a){$(t).is("[data-title]")&&u.tooltipEl(t),$(t).on("click",function(){u.showHideContentItems(e,a)})},this.showHideContentItems=function(e,t){var a=$("#content-switcher");$(t).hasClass("open")||($(e).each(function(){u.removeOpenClass($(this)),$(a).find("a").each(function(){u.removeActiveClass($(this))})}),u.addOpenClass($(t)),u.addActiveClass($(a).find("a").eq($(t).index())),n=t,u.tryLoadContainer($(t).find(".content-partial:not([data-tab-empty])")),$(t).index()||u.manageOpenTab(),$(n).find("[data-tab-empty]").length&&u.deleteRightBtnMenuAdditionalBtn(),setTimeout(function(){u.updateNiceScroll(),u.initAllInputTextareaAfterLoad(),u.onLoadCheckAllInputs()},500))},this.manageDetailesContent=function(){if($("div").is(".content-details"))for(var e,t,a,i,n=$(".content-details"),r=n.length,s=0;s<r;s++)e=n[s],t=$(e).find(".content-details-group"),a=n.width(),i=t.width(),t.removeClass("content-item-hover"),a<i?t.addClass("content-item-hover"):t.removeClass("content-item-hover")},this.initAllInputTextareaAfterLoad=function(){$("input").is(".input")&&$(".input").each(function(){u.initInputAfterLoad($(this))}),$("textarea").is(".textarea")&&$(".input").each(function(){u.initTextareaAfterLoad($(this))})},this.initTextareaAfterLoad=function(e){$("textarea").on("blur",function(){u.addEmptyNotEmptyClass($(this))}),$("textarea").on("focus",function(){u.closeAllSelect(s)})},this.initInputAfterLoad=function(e){$(e).on("blur",function(){u.addEmptyNotEmptyClass($(this))}),$(e).on("focus",function(){var e=$.trim($(this).val());"0"!=e&&"0.00"!=e&&"0,00"!=e&&"0,0"!=e&&"0.0"!=e||$(this).select(),u.closeAllSelect(s)}),u.addEmptyNotEmptyClass(e)},this.onLoadCheckAllInputs=function(){$("input").each(function(){u.addEmptyNotEmptyClass($(this)),$(this).is("[readonly]")&&$(this).addClass("input-readonly"),$(this).hasClass("input-file")&&u.inputFileCustomization($(this))}),$("textarea").each(function(){u.addEmptyNotEmptyClass($(this))})},this.inputFileCustomization=function(e){var t=$(e).next("label");$(t).val();$(e).on("change",function(e){var t="";this.files&&1<this.files.length?t=(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value&&(t=e.target.value.split("\\").pop()),t&&$(".content-upload-filename").html(t)})},this.checkboxGroupAnimation=function(a){var i=!0;a.on("change",function(){if(i){var e=a.closest(".checkbox-group").find(".checkbox-group-bar"),t=e.css("transition-duration");i=!1,t=1e3*+(t=t.slice(0,-1)),e.addClass("on"),setTimeout(function(){e.removeClass("on"),i=!0},t)}})},this.createCheckboxLabel=function(e){$(e).find("input.checkbox").each(function(){if($(this).is(":visible")){var e="checkbox"+u.generateId();$(this).addClass("checkbox").attr("id",e).after('<label for = "'+e+'"></label>')}}),$(e).find("input.check-box").each(function(){if($(this).is(":visible")){var e="checkbox"+u.generateId();$(this).addClass("checkbox").attr("id",e).after('<label for = "'+e+'"></label>')}})},$("input").is(".check-box")&&$(".check-box").each(function(){var e="checkbox"+u.generateId();$(this).addClass("checkbox").attr("id",e).after('<label for = "'+e+'"></label>')}),this.setLabelMultiSelect=function(e){var t=e,c=$(t).siblings(".ms-options-wrap"),d=$(c).find("button span.ms-hidden-label");$(t).bind("change",function(e){e.stopPropagation();var o=$(this),l=$(o).siblings(".ms-options-wrap.ms-has-selections");setTimeout(function(){for(var e,t=[],a=[],i=$(d).html().split(", "),n=$(c).find(".ms-options ul li.selected"),r=0;n.length>r;r++){var s=$(n[r]).text();a.push(s)}a.length>i.length?t=i:a.length==i.length?t=a:$(l).find("button .ms-label").remove(),e="";for(r=0;t.length>r;r++)$(l).find("button .ms-label").remove(),e+='<div class="ms-label">'+t[r]+"</div>";$(c).hasClass("ms-has-selections")?$(d).addClass("hidden"):$(d).removeClass("hidden"),u.addMslabel(o,e)},0)})},this.addMslabel=function(e,t){var a=$(e).siblings(".ms-options-wrap.ms-has-selections").find("button");$(t).appendTo(a)},$("select").is("[multiple].multiselect")&&$("[multiple].multiselect").each(function(){var e=$(this).attr("data-placeholder");$(this).multiselect({columns:1,selectAll:!0,texts:{placeholder:e,selectAll:"Обрати все",unselectAll:"Видалити всі позначки"}}),u.setLabelMultiSelect($(this))}),$("select").is("[multiple].multiselect-search")&&$("[multiple].multiselect-search").each(function(){var e=$(this).attr("data-placeholder");$(this).multiselect({columns:1,search:!0,selectAll:!0,texts:{placeholder:e,search:"Пошук",selectAll:"Обрати все",unselectAll:"Видалити всі позначки"}}),u.setLabelMultiSelect($(this))}),$(".ms-options-wrap .ms-options")&&setTimeout(function(){$(".ms-options-wrap .ms-options").each(function(){u.createSelectScrollBar($(this).get(0))})},0),this.openModal=function(){$(S).addClass("open"),$(F).on("click",function(){u.closeModal()})},this.closeModal=function(){$(S).removeClass("open"),u.clearElEventListeners($(x)),setTimeout(function(){u.toggleModalClass(S),u.clearModal()},300)},this.clearModal=function(){$(x).html(""),$(x).removeAttr("data-tab-container-url")},this.getModalContent=function(e){$(x).attr("data-tab-container-url",e),u.tryLoadContainer($(S).find("[data-tab-container-url]"))},this.getModalPosition=function(e){var t=$(e).attr("data-modal");switch(t){case"modal-right":case"modal-left":case"modal-center":case"modal-top":case"modal-bottom":case"modal-fs":u.toggleModalClass(S,t);break;default:u.toggleModalClass(S,"modal-center")}},this.toggleModalClass=function(e,t){$(e).is('[class^="modal-"]')?$(e).removeClass(function(e,t){return(t.match(/(^|\s)modal-\S+/g)||[]).join(" ")}):$(e).addClass(t)},y&&$(y).on("click",function(){var e=$(this).attr("data-tab-container-url");u.getModalPosition($(this)),$.when(u.getModalContent(e)).done(u.closeAllOpenLi(A)).done(function(){setTimeout(function(){u.openModal()},300)})}),this.activateModalBtn=function(e){$(e).find("[data-modal]").each(function(){$(this).on("click",function(){var e=$(this).attr("data-tab-container-url");u.getModalPosition($(this)),$.when(u.getModalContent(e)).done(u.closeAllOpenLi(A)).done(function(){setTimeout(function(){u.openModal()},300)})})})},this.fastSelectControl=function(e){(e=$(e)).fastselect({placeholder:"",searchPlaceholder:"",noResultsText:"Результат не знайдено"}),void 0!==e.attr("readonly")&&e.prev(".fstControls").find("button, input").remove(),e.on("change",function(){console.log("onchange",e.val())}),e.on("focus",function(){console.log("focus",e.val())}),e.on("blur",function(){console.log("blur",e.val())})},$("select").is(".fastselect")&&$(".fastselect").each(function(){u.fastSelectControl($(this))}),this.onChangeUrl=function(e,t){var a,i={};t?(a=t,i[$(e).attr("name")]=$(e).val()):(a=$(e).attr("onchange-url"),$("[onchange-url='"+a+"']").each(function(){i[$(this).attr("name")]=$(this).val()}));var n=s.find("[onchange-url]");0<$(n).val().length&&$.ajax({url:a,type:"POST",data:i,success:function(e){response=$.parseJSON(JSON.stringify(e)),$.each(Object.keys(response),function(e,t){var o,l=response[t];l&&(o=t.match("^#")?$(t):$("[name='"+t+"']"),$.each(o,function(e,t){var a=u.returnTagName(t);if("select"===a){var i,n=$(o).find("option"),r=$(o).closest(".select-group-inner");if($(r).hasClass("select-readonly")){$(t).html("");for(var s=0;s<l.length;s++)(i=document.createElement("option")).value=l[s].value,i.innerHTML=l[s].text,l[s].selected&&i.setAttribute("selected","selected"),l[s].disabled&&i.setAttribute("disabled","disabled"),$(t).append(i)}else for(s=0;s<n.length;s++)i=n[s],l==i.value&&($(i).prop("selected","selected"),i.setAttribute("selected","selected"));l.length<=0&&$(t).html(""),u.updateSelectList($(t))}else"input"===a?($(t).val(l),u.addEmptyNotEmptyClass($(t))):$(t).text(l)}))})}})},$(document).on("change","[onchange-url]",function(e){u.onChangeUrl($(this))}),this.setDataTabGroup=function(e){$(e).find("[ data-tab-open]").length&&$(e).find("[ data-tab-open]").on("click",function(){u.showDataTabGroup(e)}),$(e).find("select").length&&$(e).find("select").each(function(){$(this).addClass(".select"),u.selectWrap($(this))}),$(e).find("input").length&&$(e).find("input").each(function(){$(this).addClass("input"),u.initInputAfterLoad($(this))})},this.showDataTabGroup=function(e){E=!0,u.addOpenClass(e)},this.hideDataTabGroup=function(){$(".data-tab-group").each(function(){u.removeOpenClass($(this))}),E=!1},this.manageOpenTab=function(){u.deleteRightBtnMenuAdditionalBtn(),$(n).find("[data-tab]").length&&$(n).find("[data-tab]").each(function(){u.addRightBtnMenuAdditionalBtn($(this))})},this.deleteRightBtnMenuAdditionalBtn=function(){$(c).find("[data-tab]").length&&$(c).find("[data-tab]").each(function(){u.clearElEventListeners($(this)),$(this).off(),$(this).detach()}),$(c).find("[data-tab-main]").length&&$(c).find("[data-tab-main]").each(function(){$(n).index()?$(this).css("display","none"):$(this).css("display","")}),u.manageRightBtnMenu()},this.addRightBtnMenuAdditionalBtn=function(e){var t=$(e).clone();$(t).appendTo(c),$(t).hasClass("data-tab-group")?(u.setDataTabGroup(t),u.setToolTipsForChild(t)):u.tooltipEl(t),u.manageRightBtnMenu()},this.autocompleteEl=function(e){var t=$(e).attr("autocomplete-url"),a=$(e).attr("autocomplete-idinput-name"),i=$(e).attr("autocomplete-init-id"),r=$(e).attr("autocomplete-onsuccess"),n=$(e).attr("autocomplete-onselect"),s=($(e).attr("autocomplete-onblur"),$(e).attr("autocomplete-params")),o=""===$(e).attr("autocomplete-allowcreate");params=s?s.split(","):null;var l=$(e).closest("form"),c=a||$(e).attr("name").replace("Name","Id");c.endsWith("Id")||(c+="Id");var d=$(l).find("input[name='"+c+"']");0===$(d).length&&($(e).after('<input type="hidden" name="'+c+'" id="'+c+'"/>'),(d=$(l).find("input[name='"+c+"']")).val(i||"")),$(e).autocomplete({source:function(a,i){var n={};params&&(console.log(params),$.each(params,function(e,t){n[t]=$("#"+t).val()})),n.term=a.term,$.ajax({url:t,type:"POST",dataType:"json",data:n,success:function(e){r&&(new Function("data",r)(e),console.log(e)),0!==e.length||o||e.push({label:"Відповідності не знайдено",value:"",option:""}),o||d.val("");for(var t=0;t<e.length;t++)if(item=e[t],item.label==a.term){d.val(item.option);break}i($.map(e,function(e){return{label:e.label,value:e.value,option:e.option,data:e.data}}))}})},classes:{"ui-autocomplete":"input-group-autocomplete"},minLength:0,select:function(e,t){""===t.item.option&&(t.item.value=""),d.val(t.item?t.item.option:""),n&&new Function("item",n)(t.item)},create:function(e){$(".ui-helper-hidden-accessible").remove()}}).focus(function(){var e=$(this).val();$(this).data("uiAutocomplete").search(e||"")})},$("*").is("[autocomplete-url]")&&$("[autocomplete-url]").each(function(){u.autocompleteEl($(this))}),$.widget("custom.combobox",{_create:function(){this.wrapper=$("<span>").addClass("custom-combobox").insertAfter(this.element),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var e=this.element.children(":selected"),t=e.val()?e.text():"";this.input=$("<input>").appendTo(this.wrapper).val(t).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:$.proxy(this,"_source")}).tooltip({classes:{"ui-tooltip":"ui-state-highlight"}}),this._on(this.input,{autocompleteselect:function(e,t){t.item.option.selected=!0,this._trigger("select",e,{item:t.item.option})},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var e=this.input,t=!1;$("<a>").attr("tabIndex",-1).attr("title","Show All Items").tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").on("mousedown",function(){t=e.autocomplete("widget").is(":visible")}).on("click",function(){e.trigger("focus"),t||e.autocomplete("search","")})},_source:function(t,e){var a=new RegExp($.ui.autocomplete.escapeRegex(t.term),"i");e(this.element.children("option").map(function(){var e=$(this).text();if(this.value&&(!t.term||a.test(e)))return{label:e,value:e,option:this}}))},_removeIfInvalid:function(e,t){if(!t.item){var a=this.input.val(),i=a.toLowerCase(),n=!1;this.element.children("option").each(function(){if($(this).text().toLowerCase()===i)return this.selected=n=!0,!1}),n||(this.input.val("").attr("title",a+" didn't match any item").tooltip("open"),this.element.val(""),this._delay(function(){this.input.tooltip("close").attr("title","")},2500),this.input.autocomplete("instance").term="")}},_destroy:function(){this.wrapper.remove(),this.element.show()}}),this.createValidateAttr=function(e){for(var t=" validate ",a=0;a<e.length;a++)t+="validate-"+e[a]+" ";return t},this.returnValidateMsg=function(e){switch(e){case"required":case"not-empty":return"Обов'язкове поле";case"number":return"Значення має бути числом";case"phone":return"Невірно введений номер";case"email":return"Невірний формат email";case"equal-to":return"Значення не співпадають";case"length-max":return"Максимальна кількість знаків ";case"length-min":return"Мінімальна кількість знаків ";case"range":return"Значення має бути у діапазоні від ";case"url":return"Невірний формат url-адреси";case"creditcard":return"Невірний номер картки";case"pattern":return"Недопустиме значення";case"date":return"Невірний формат дати"}},this.findValidateForm=function(e){function t(t){var e=$(t).find('input[type = "submit"]')||$(t).find('button[type = "submit"]')||$(t).find(".submit-form-button");$(e).off().on("click",function(e){$(t).hasClass("no-validate")?$(t).submit():u.checkFormBeforeSubmit(e,t)})}"form"==u.returnTagName(e)?t(e):$(e).find("form").each(function(){t($(this))}),$(e).find('[data-val-required]:not([type="checkbox"])').each(function(){currEl=$(this),currEl.siblings("label").append("*")})},this.checkFormBeforeSubmit=function(e,t){e.preventDefault(),u.validateForm(t)?$(t).submit():$("html, body").animate({scrollTop:$(".asp-validation.active").first().offset().top-120},700)},this.showNotValidMsg=function(e,t){var a,i=u.returnTagName(e);"input"==i&&(a=$(e).closest(".input-group")),"select"==i&&(a=$(e).closest(".select-group"));var n=$(a).find(".asp-validation");function r(){u.removeActiveClass(n),setTimeout(function(){$(a).find(".asp-validation").text("")},T),$(a).off("mouseover",r),$(a).find("input").each(function(){$(this).unbind("focus",r)})}n.length&&($(n).text(t),u.addActiveClass(n),$(a).on("mouseover",r),$(a).find("input").each(function(){$(this).bind("focus",r)}))},this.validateForm=function(e){if(e&&e.length){var n,t,r=!0;return $(e).find("[data-val-required]").each(function(){t=$(this);$(this).attr("data-val-required");(n=u.validateRequired(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[no-validate]").each(function(){t=$(this),r=!0}),$(e).find("[validate-not-empty]").each(function(){t=$(this),(n=u.validateNotEmpty(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[validate-number]").each(function(){t=$(this),(n=u.validateNumber(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[data-val-phone]").each(function(){t=$(this);$(this).attr("data-val-phone");(n=u.validatePhone(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[data-val-email]").each(function(){t=$(this),(n=u.validateEmail(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[data-val-equalto-other]").each(function(){var e,t,a,i;t=(e=$(this)).val(),a="#"+e.attr("data-val-equalto-other").replace(/[^\w\s]/gi,""),i=$(a).val(),(n=u.validateEqualTo(t,i))&&(r=!1,u.showNotValidMsg(e,n),u.showNotValidMsg($(a),n))}),$(e).find("[data-val-length-max]").each(function(){var e,t,a;e=$(this);$(this).attr("data-val-length");t=e.val().length,a=e.attr("data-val-length-max"),(n=u.validateLengthMax(t,a))&&(r=!1,n+=a,u.showNotValidMsg(e,n))}),$(e).find("[data-val-length-min]").each(function(){var e,t,a;e=$(this);$(this).attr("data-val-length");t=e.val().length,a=e.attr("data-val-length-min"),(n=u.validateLengthMin(t,a))&&(r=!1,n+=a,u.showNotValidMsg(e,n))}),$(e).find("[data-val-range]").each(function(){var e,t,a;e=$(this);$(this).attr("data-val-range");t=+e.attr("data-val-range-max"),a=+e.attr("data-val-range-min"),(n=u.validateRange(e,a,t))&&(r=!1,n+=a+" до "+t,u.showNotValidMsg(e,n))}),$(e).find("[data-val-url]").each(function(){t=$(this),(n=u.validateUrl(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[data-val-creditcard]").each(function(){t=$(this),(n=u.validateCreditCard(t))&&(r=!1,u.showNotValidMsg(t,n))}),$(e).find("[validate-date]").each(function(){t=$(this),(n=u.validateDate(t))&&(r=!1,u.showNotValidMsg(t,n))}),r}},this.validateRequired=function(e){return!!u.isElValueEmpty(e)&&u.returnValidateMsg("required")},this.validateNotEmpty=function(e){return!!u.isElValueEmpty(e)&&u.returnValidateMsg("not-empty")},this.validateNumber=function(e){return!u.isElValueEmpty(e)&&(!/^(0|[1-9]\d*)([\,\.]{1}\d+)?$/.test($(e).val())&&u.returnValidateMsg("number"))},this.validatePhone=function(e){if(u.isElValueEmpty(e))return!1;var t=$(e).val().replace(/\D+/g,"");return!/^[0-9]{12}$/.test(t)&&u.returnValidateMsg("phone")},this.validateEmail=function(e){return!u.isElValueEmpty(e)&&(!/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test($(e).val())&&u.returnValidateMsg("email"))},this.validateEqualTo=function(e,t){return e!==t&&u.returnValidateMsg("equal-to")},this.validateLengthMax=function(e,t){return t<e&&u.returnValidateMsg("length-max")},this.validateLengthMin=function(e,t){return e<t&&0<e&&u.returnValidateMsg("length-min")},this.validateRange=function(e,t,a){return elVal=+e.val(),elValLength=e.val().length,0!=elValLength&&((elVal<t||elVal>a)&&u.returnValidateMsg("range"))},this.validateUrl=function(e){return!u.isElValueEmpty(e)&&(!/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/g.test($(e).val())&&u.returnValidateMsg("url"))},this.validateCreditCard=function(e){if(u.isElValueEmpty(e))return!1;var t=$(e).val().replace(/\D+/g,"");return!/^(?:4[0-9]{12}(?:[0-9]{3})?|[25][1-7][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/g.test(t)&&u.returnValidateMsg("creditcard")},this.validateDate=function(e){return!u.isElValueEmpty(e)&&(!/^\s*(3[01]|[12][0-9]|0?[1-9])\.(1[012]|0?[1-9])\.((?:19|20)\d{2})\s*$/g.test($(e).val())&&u.returnValidateMsg("date"))},$(".phone").inputmask({alias:"phone",mask:"+380(99)999-99-99",showMaskOnHover:!1,removeMaskOnSubmit:!1}),this.createPaging=function(a){var e=$(a).find("[data-pgparams]");if(e){var i=e.data("pgparams");i&&($(a).find(".pagination")&&$(a).find(".pagination a").each(function(){var t=$(this).attr("href")+"&"+i;$(this).on("click",function(e){e.preventDefault(),u.showLoader(a),u.doPaging(t,a),u.updateNiceScroll()})}),$(a).find(".content-list-sortable")&&$(a).find(".content-list-sortable a").each(function(){var t=$(this).attr("href")+"&"+i;$(this).on("click",function(e){e.preventDefault(),e.stopPropagation(),u.showLoader(a),u.doPaging(t,a),u.updateNiceScroll()})}))}},this.doPaging=function(e,t){$.ajax({url:e,type:"GET",success:function(e){$.when(u.clearPaging(t)).done($(t).html(e)).done(u.createPaging(t)).done(u.findGrids($(t)),u.initMask(t)).done(u.setDeleteContentListItem($(t))).done(u.createCheckboxLabel(t)).done(u.updateNiceScroll()).done(u.hideLoader(t))},error:function(e){console.error("doPaging error",e)}})},this.clearPaging=function(e){var t;t=$(e).data("ajax-update")?$(e).data("ajax-update"):$(e),u.clearElEventListeners(t)},this.findPaging=function(){$("*").is("[data-pgparams]")&&$("[data-pgparams]").each(function(){u.createPaging($(this))})},this.deleteContentListItem=function(s){$(s).on("click",function(t){t.preventDefault();var e=$(this).attr("disabled");if(void 0===e||!1===e){$(this).attr("disabled","disabled");var a=$(t.target).closest(".content-list"),i=$(this).attr("href"),n="<p>Ви впевнені що хочете видалити запис?</p>";u.createDialog(t,n,function(){$.ajax({type:"Post",url:i,complete:function(e,t,a){console.log(e.status),console.log(t),console.log(a)},error:function(e){console.log("error",e),$(s).removeAttr("disabled"),n="<p>Помилка видалення</p>",u.createDialog(t,n,r)},success:function(e){console.log("success",e),$(s).removeAttr("disabled"),a.remove(),u.updateNiceScroll(),$(".btn-add-state").length&&u.checkBtnState()}})},r)}function r(){$(s).removeAttr("disabled")}})},this.setDeleteContentListItem=function(e){$(e).find(".content-list-delete a").each(function(){u.deleteContentListItem($(this))})},$("div").is(".content-list-delete")&&u.setDeleteContentListItem(s),this.checkBtnState=function(){var e;e="ApplicationSetting/IsPossibleToAddNew",$.ajax({type:"Post",url:e,error:function(e){},success:function(e){e?$(t).removeClass("btn-disabled"):$(t).addClass("btn-disabled")}});var t=$(c).find(".btn-add-state")},this.tryLoadContainer=function(n,r){u.showLoader(n),n&&(u.updateNiceScroll(),$(n).each(function(e,t){var a=r||$(t).attr("data-tab-container-url"),i=$(t).attr("data-replace");a.length&&$.ajax({type:"Get",url:a,success:function(e){return""===i?$.when($(t).replaceWith(e)).done(u.initMask(n),u.findFormatDateParagraph(n)).done(u.findGrids(n)).done(u.findPaging(n)).done(function(){u.manageOpenTab(),u.showHideFooter(),u.updateNiceScroll(),u.hideLoader(n),u.setToolTipsForChild(n),u.findValidateForm(n),u.setDeleteContentListItem(n),u.manageContentReload(n),u.initTextareaAfterLoad()}):$.when($(t).html(e)).done(u.initMask(n),u.findFormatDateParagraph(n)).done(u.findGrids(n)).done(u.createCheckboxLabel(n)).done(u.findPaging(n)).done(function(){u.manageOpenTab(),u.showHideFooter(),u.updateNiceScroll(),u.hideLoader(n),u.setToolTipsForChild(n),u.findValidateForm(n),u.setDeleteContentListItem(n),u.manageContentReload(n),u.initTextareaAfterLoad(),u.activateModalBtn($(this))}),!0},error:function(){return $(t).html(""),u.hideLoader(n),u.closeModal(),msg="<p>Помилка! Перезагрузіть сторінку.</p>",u.createDialog(!0,msg),!0}})}))},s.on("click",function(e){var t=e.target;if(!w){if(I||N){if($(t).is($(".content-search-form"))||$(t).closest("form").is($(".content-search-form")))return;if(O)return;u.closeSearchFormHolderAndPresetFilters()}if(C){if($(t).is($(".select-list"))||$(t).is($(".select-gap"))||$(t).closest("ul").is(".select-list"))return;u.closeAllSelect()}if(E){if($(t).closest(".data-tab-group").is("[data-tab]"))return;u.hideDataTabGroup()}}}),this.initMask=function(e){var t;$(e).find(".mask").each(function(){"input"==(t=u.returnTagName($(this)))&&u.setInputMask($(this)),"p"==t&&u.setMaskedParagraph($(this))})},this.setInputMask=function(r){var s,e,t,a=$(r).parent(),i=$(r).attr("name"),n=$(r).attr("id");function o(){var e=$(r).val(),t=e.replace(/\s/g,""),a=(t=t.replace(/,/g,".")).split("."),i=a[0],n=a[1];$(r).hasClass("mask-money-dec")&&(n=u.returnDec(n,2)),e=(i=i.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 "))+"."+n,$(s).val(t),$(r).val(e)}$(a).append('<input id = "'+n+'" class = "data-mask" type = "hidden" name = "'+i+'"/>'),$(r).attr("name",""),$(r).attr("id",""),s=$(a).find("[name = "+i+"]"),u.isElValueEmpty(r)||o(),$(r).focus(function(){t=(t=(t=$(r).val()).replace(/\s/g,"")).replace(/,/g,"."),$(r).val(t)}),$(r).blur(o),$(r).on("input",function(){e=u.getCaretPosition($(r)[0]),t=(t=$(r).val()).replace(/,/g,"."),/^[0-9]{0,12}([\.][0-9]{0,2})?$/.test(t)||(t=t.substring(0,e-1)+t.substring(e,t.length),window.setTimeout(function(){u.setCaretPosition($(r)[0],e-1),e=u.getCaretPosition($(r)[0])},0)),$(r).val(t)})},this.getCaretPosition=function(e){return e.selectionStart||"0"==e.selectionStart?e.selectionStart:0},this.setCaretPosition=function(e,t){if(null!=e)if(e.createTextRange){var a=e.createTextRange();a.move("character",t),a.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},this.setMaskedParagraph=function(e){var t,a,i,n=$(e).text();a=(t=(n=n.replace(/,/g,".")).split("."))[0],i=t[1],$(e).hasClass("mask-money-dec")&&(i=u.returnDec(i,2)),a=a.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 "),$(e).text(a+"."+i)},this.returnDec=function(e,t){if(2==t)return!e||void 0===e||0==e.length||isNaN(+e)?"00":1==e.length?e+"0":2<e.length?(4<+(e=e.split(""))[2]&&(e[1]=+e[1]+1),e[0]+e[1]):e},this.setGrid=function(e){var t,a,i=$(e).children(),n=i.length,r="",s=" ";if(n){for(var o=0;o<n;o++)t=i[o],3<(a=$(t).data("grid")?+(a=$(t).data("grid")):1)&&(a=3),a<1&&(a=1),s=s+"_"+o+" ",r+="1fr ",1<a&&(s=s+"_"+o+" ",r+="1fr "),2<a&&(s=s+"_"+o+" ",r+="1fr ");$(e).css({"grid-template-columns":r,"grid-template-areas":'"'+s+'"'}),$(e).closest(".content-list-header")&&$(e).closest(".content-list-header").siblings(".content-list").each(function(){$(this).find(".grid-container-nested").each(function(){$(this).css({"grid-template-columns":r,"grid-template-areas":'"'+s+'"'})})}),u.manageGridContent()}},this.manageGridContent=function(){if($("div").is(".grid"))for(var e,t,a,i,n,r,s,o=$(".grid"),l=o.length,c=0;c<l;c++){if(e=o[c],(t=$(e).children(".grid-inner")).removeClass("grid-hover"),t.removeClass("grid-hover-height"),n=t.children("p:not(.mask-money-dec)"),a=t.outerWidth(),r=n.width(),i=t.outerHeight(),s=n.height(),1<n.length)for(var d=0;d<n.length;d++){var u=n[d],h=$(u).width();r<h&&(r=h),s+=$(u).height()}t.removeClass("grid-hover"),t.removeClass("grid-hover-height"),i<s&&a<r?t.addClass("grid-hover-height"):i<s?t.addClass("grid-hover-height"):a<r?t.addClass("grid-hover"):(t.removeClass("grid-hover"),t.removeClass("grid-hover-height"))}},this.findGrids=function(e){$(e).find(".grid-container").each(function(){u.setGrid($(this)),setTimeout(function(){$("a").is(".content-list-link")&&u.addContentListLink(s)},0)})},$("div").is(".grid-container")&&$(".grid-container").each(function(){u.setGrid($(this))}),this.addContentListLink=function(e){$(e).find(".content-list-link").each(function(){var e=$(this).siblings(".content-list-edit").children(".btn-link").attr("href");$(this).attr("href",e)})},this.createMessenger=function(){var t,n=$("#frame-wrapper"),a=!0,e=n.find(".frame-close"),i=$(window),r=0,s=0,o='<iframe class = "frame" src="'+n.data("url")+'"  frameborder="0" scrolling="no"></iframe>',l=parseInt(n.css("width")),c=parseInt(n.css("height"));function d(){a||(r=i.height(),s=i.width(),function(){r<c?n.css({height:r+"px",transform:"translateY(-"+r/2+"px)"}):c!=n.height()&&n.css({top:"50%",height:"",transform:"translateY(-"+n.height()/2+"px)"});s<l?n.css({width:s+"px",left:"0"}):n.width()<l&&n.css({width:l+"px"})}())}$("#show-messenger").on("click",function(){a&&$.when((a=!1,void n.append(o))).then((d(),void n.css({"z-index":"2000",opacity:"","max-width":"80%",transition:".05s",top:"50%",transform:"translateY(-"+n.height()/2+"px)"}).animate({right:0},T))).then(u.closeAllOpenLi($("#header-account-menu")))}),$(e).on("click",function(){a=!0,n.animate({opacity:0},500,function(){n.css({top:"",right:"-390px","max-width":"0",left:"","z-index":"-1",transition:""})}),setTimeout(function(){$(".frame").remove()},T)}),n.draggable({drag:function(e,t){var a,i;t.position.top=((a=t.position.top)<0&&(a=0),a>r-n.height()&&(a=r-n.height()),a+n.height()/2),t.position.left=((i=t.position.left)<0&&(i=0),i>s-n.width()&&(i=s-n.width()),i)}}),i.on("resize",function(e){a||(clearTimeout(t),t=setTimeout(function(){d()},62))})},$("span").is("#show-messenger")&&u.createMessenger(),this.tooltipEl=function(e){$(e).attr("title",$(e).data("title")),$(e).removeData("title"),$(e).data("tooltipleft")?$(e).tooltip({position:{my:"right-15 center",at:"left center"},classes:{"ui-tooltip":"tooltip tooltip-left"}}):$(e).data("tooltipright")?$(e).tooltip({position:{my:"left+15 center",at:"right center"},classes:{"ui-tooltip":"tooltip tooltip-right"}}):$(e).tooltip()},this.setTooltips=function(){$("[data-title]").each(function(){u.tooltipEl($(this))})},this.setToolTipsForChild=function(e){$(e).find("[data-title]").each(function(){u.tooltipEl($(this))})},$("*").is("[data-title]")&&u.setTooltips(),this.showLoader=function(e){var t=$(e).parent();t.find(".loader-wrapper").length?($(".loader-wrapper").remove(),t.removeClass("loader-parent")):(t.addClass("loader-parent"),t.append('<div class="loader-wrapper"><div class="loader"></div></div>'))},this.hideLoader=function(e){var t=$(e).parent();$(t).hasClass("loader-parent")&&($(".loader-wrapper").remove(),t.removeClass("loader-parent"))},localStorage.formCache=localStorage.formCache||"{}",a=JSON.parse(localStorage.formCache),this.saveToStorage=function(e,t){a[e]=t,localStorage.formCache=JSON.stringify(a)},this.onAjaxComplete=function(e,t,a,i){var n,r,s,o,l,c;if(o=[],n=JSON.parse(e.responseText),"success"===t&&!0===n.success)u.getAjaxContainer(a,i);else if("success"===t&&!1===n.success){for(key in n.errors)l="<li>"+(s=n.errors[key]).item1+" "+s.item2+"</li>",o.push(l);r=o.join(""),c=r,$(a).find(".validation-summary-errors ul").html(""+c)}},this.getAjaxContainer=function(e,t){u.showLoader(),e.load(t,function(){u.manageContentReload(e)})},this.manageContentReload=function(e){u.findGrids(e),u.createCheckboxLabel(e),u.initTextareaAfterLoad(),u.setDeleteContentListItem(e),$(e).find("data-pgparams")&&$("[data-pgparams]").each(function(){u.createPaging($(e))}),$(e).find("select").length&&$(e).find("select").not(".multiselect").not(".standard-select").each(function(){$(this).addClass("select"),u.selectWrap($(this))}),$("input").is(".input")&&$(".input").each(function(){u.initInputAfterLoad($(this))}),$("input").is(".input")&&$(".input").each(function(){u.onLoadCheckAllInputs($(this))}),$("input").is(".datepicker")&&$(".datepicker").each(function(){u.createDatePicker($(this))}),$(e).find("[multiple].multiselect").length&&$(e).find("[multiple].multiselect").each(function(){$("[multiple].multiselect").each(function(){var e=$(this).attr("data-placeholder");$(this).multiselect({columns:1,selectAll:!0,texts:{placeholder:e,selectAll:"Обрати все",unselectAll:"Видалити всі позначки"}}),u.setLabelMultiSelect($(this))})}),u.updateNiceScroll(e),u.hideLoader()},this.buildContentTree=function(e,t,a,i,n,r,s,o){if(u.createTreeData(e,a),u.setCheckedData(t,a),"boolean"==typeof s&&(u.setChangedItems(o,a,s),u.editTreeContentListeners(a,s)),n){var l=$(n).attr("action");u.submitTreeContent(r,i,n,l,s)}},this.createTreeData=function(e,t){var a=JSON.parse(e);$(t).html(u.createTreeDataTemplate(a.FirstLevels)),u.addEventListenerContentTree(t)},this.createTreeDataTemplate=function(e){for(var t,a=e,i='<ul class = "parent-item">',n=0;n<a.length;n++)(t=a[n]).ChildItems&&t.ChildItems.length?(i+='<li class="child-item"><div class="header-item"><input id = "'+t.Code+'" class="checkbox header-checkbox" type="checkbox" name="'+t.Name+'"/><label for="'+t.Code+'">'+t.Code+" "+t.Name+'</label><button type="button" class="btn btn-square btn-tiny icon-sm btn-parent"></button></div>',i+=u.createTreeDataTemplate(t.ChildItems)):null!==t.Caption&&void 0!==t.Caption?i+='<li class="child-item caption-item"><input id = "'+t.Code+'" class="checkbox caption-checkbox" type="checkbox" name="'+t.Name+'"/><label for="'+t.Code+'">'+t.Code+" "+t.Name+'</label><input class="caption-input" type="text" disabled>':i+='<li class="child-item last-item"><input id = "'+t.Code+'" class="checkbox" type="checkbox" name="'+t.Name+'"/><label for="'+t.Code+'">'+t.Code+" "+t.Name+"</label>",i+="</li>";return i+="</ul>"},this.addEventListenerContentTree=function(e){var t,a,n,r,s,o;t=$(e).find(".btn-parent"),a=$(e).find(".header-item"),n=$(a).find('input[type="checkbox"]'),r=$(e).find(".child-item"),s=$(r).find('input[type="checkbox"]'),o=$(s).siblings("input.caption-input"),$(e).on("change","input[type='checkbox']",function(){var e=$(this).closest(".header-item").siblings(".parent-item").find("input[type='checkbox']").not(".caption-checkbox, .checkbox-disabled");if($(this).is(":checked")?e.prop("checked",!0):e.prop("checked",!1),$(this).is(":not(:checked)")){var t=$(this).parents(".parent-item").prev(".header-item");for(i=0;i<t.length;i++){e=$(t[i]).next(".parent-item").find("input[type='checkbox']").not(".caption-checkbox, .checkbox-disabled");for(var a=!1,n=0;n<e.length;n++)1==e[n].checked&&(a=!0);1!=a&&$(t[i]).find("input[type='checkbox']").prop("checked",!1)}}}),$(s).parent().is(".caption-item")&&($(s).on("change",function(){var e;if((e=$(this).siblings("input.caption-input")).is("[disabled]")?$(e).removeAttr("disabled"):$(e).attr("disabled","disabled"),$(this).is(":checked")){var t=$(this).parents(".parent-item").prev(".header-item");$(t).find("input[type='checkbox']").prop("checked",!0)}}),$(o).on("change",function(){var e=$(this).val(),t=$(this).siblings('input[type="checkbox"]');$(t).attr("value",e)})),$(t).on("click",function(){$(this).toggleClass("is-transform"),$(this).parent(n).next().slideToggle()})},this.setCheckedData=function(e,t){if(null!==e&&0<e.length){var a=JSON.parse(e);for(item in a){var i=a[item],n=i.id,r=i.value,s=n.replace(/(?:\.)/g,"\\."),o=$(t).find("#"+s);$(o).prop("checked",!0),$(o).hasClass("caption-checkbox")&&($(o).val(r),$(o).siblings(".caption-input").val(r).removeAttr("disabled"))}}},this.setChangedItems=function(e,t,a){if(null!==e&&0<e.length){var i=JSON.parse(e);for(item in i){var n=i[item],r=n.id,s=n.value,o=r.replace(/(?:\.)/g,"\\."),l=$(t).find("#"+o);a?($(l).prop("checked",!1),$(l).addClass("checkbox-deleted")):($(l).prop("checked",!0),$(l).addClass("checkbox-added")),$(l).hasClass("caption-checkbox")&&($(l).val(s),$(l).siblings(".caption-input").val(s).removeAttr("disabled"))}}},this.getTreeContentData=function(e,t,a){var i=$(e).find("#content-tree"),n=[];checkedArr=!0===a?$(i).find(".checkbox-deleted").not(".checkbox-disabled"):!1===a?$(i).find(".checkbox-added").not(".checkbox-disabled"):$(i).find("input:checked");for(var r=0;r<checkedArr.length;r++){var s=checkedArr[r],o={id:$(s).attr("id"),value:$(s).attr("value")};n.push(o)}var l=JSON.stringify(n);$(e).find(t).val(l)},this.submitTreeContent=function(e,t,a,i,n){$(e).on("click",function(e){e.preventDefault(),u.getTreeContentData(a,t,n),u.validateForm(a,i)?$.ajax({type:"post",url:i,data:$(a).serialize()}).done(function(e){if("success"===e.status){return"referrer"in document?window.location=document.referrer+e.tab:window.history.back(-1),!1}else console.log("response_status",e.status)}):$("html, body").animate({scrollTop:$(".asp-validation.active").first().offset().top-180},700)})},this.editTreeContentListeners=function(e,a){var t=$("#content-tree .checkbox:not(:checked)"),i=$("#content-tree .checkbox:checked");a?($(t).not(".checkbox-deleted").addClass("checkbox-disabled"),$(t).hasClass("caption-checkbox")&&$(t).siblings(".caption-input").attr("disabled",!0)):($(i).not(".checkbox-added").addClass("checkbox-disabled"),$(i).hasClass("caption-checkbox")&&$(i).not(".checkbox-added").siblings(".caption-input").attr("disabled",!0)),$(e).on("change","input[type='checkbox']",function(){var e=$(this).closest(".header-item").siblings(".parent-item").find("input[type='checkbox']").not(".caption-checkbox, .checkbox-disabled"),t=$(this).parents(".parent-item").prev(".header-item");a?(u.removeContentItemClass($(this),e),$(this).is(":not(:checked)")&&$(t).find("input[type='checkbox']").not(".checkbox-disabled").addClass("checkbox-deleted")):(u.addContentItemClass($(this),e),$(this).is(":not(:checked)")&&$(t).find("input[type='checkbox']").removeClass("checkbox-added"))})},this.removeContentItemClass=function(e,t){$(e).is(":checked")?($(e).removeClass("checkbox-deleted"),$(t).removeClass("checkbox-deleted")):($(e).addClass("checkbox-deleted"),$(t).addClass("checkbox-deleted"))},this.addContentItemClass=function(e,t){$(e).is(":checked")?($(e).addClass("checkbox-added"),$(t).addClass("checkbox-added")):($(e).removeClass("checkbox-added"),$(t).removeClass("checkbox-added"))},this.currentTab=function(){var e=$(location).attr("href").split("#")[1];$("#"+e).trigger("click")},this.returnScrollHeight=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},this.returnWindowHeight=function(){return window.innerHeight},this.returnWindowInnerWidth=function(){return window.innerWidth};var V={userDisplaySettingsConfig:[{labelName:"Оберіть ширину екрану",name:"windowWidth",type:"select",selectOptions:[{Disabled:!(this.returnClientWidth=function(){document.documentElement.clientWidth}),Group:null,Selected:!1,Text:"На всю ширину",Value:0},{Disabled:!1,Group:null,Selected:!0,Text:"Широка таблиця",Value:1},{Disabled:!1,Group:null,Selected:!1,Text:"Вузька таблиця",Value:2}]},{labelName:"Установити поточну дату",name:"setCurrDate",type:"checkbox",id:"SetCurrDate",value:!0},{labelName:"Показувати підказки",name:"showTooltip",type:"checkbox",id:"ShowTooltip",value:!1},{labelName:"Зберігати дані користувача при виході",name:"saveUser",type:"checkbox",id:"saveUser",value:!0}]};this.createContentSettingsForm=function(e){if(e&&void 0!==e&&!u.isStringEmpty(e)){var t=e.userDisplaySettingsConfig;if(t&&t.length){for(var a='<div class = "settings-inner"><h3><i class="icon icon-lg icon-settings"></i>Налаштування користувача</h3>',i=0;i<t.length;i++)a+=u.selectDataTemplate(t[i]);a+="</div>";var n=$("#modal").find(".modal-container");$.when($(n).html(a)).done(u.activateFormControls(n)),u.openModal(),$(n).find(".checkbox").on("change",function(){var e=$(this).attr("name");this.checked?M[e]=!0:M[e]=!1,u.saveToStorage("user-settings",M)}),$(n).find(".select").on("change",function(){var e=$(this).attr("name"),t=$(this).val();M[e]=t,u.saveToStorage("user-settings",M)})}}},this.updateUserDisplaySettings=function(){var e=V.userDisplaySettingsConfig,t=[];for(var a in M)for(var i=0;i<e.length;i++)if(e[i].name==a&&("checkbox"==e[i].type&&(e[i].value=M[a]),"select"==e[i].type)){t=e[i].selectOptions;for(var n=0;n<t.length;n++)t[n].Selected=!1,t[n].Value==M[a]&&(t[n].Selected=!0)}},$("#show-settings").on("click",function(){u.updateUserDisplaySettings(),u.createContentSettingsForm(V),u.closeAllOpenLi(A)}),this.uploadFile=function(e){var t=$(e).closest("form"),a=$(t).attr("action"),i=$(t).find("#EntityId").val(),n=$(t).find("#EntityName").val(),r=$(t).find("#DocumentType").val(),s=$(t).find("#Description").val(),o=$(t).find("#files").get(0).files,l=new FormData;if(!o.length)return msg="<p>Відсутні вкладені файли</p>",void u.createDialog(!0,msg);for(var c=function(e,t){var a="<p>Розмір вкладеного файлу "+t+" "+(e/1024/1024).toFixed(2)+" MB</p><p>Максимальний розмір файлу має бути не більше 100 MB.</p>";u.createDialog(!0,a)},d=0;d<o.length;d++)l.append(o[d].name,o[d]),l.append("EntityId",i),l.append("EntityName",n),l.append("DocumentType",r),l.append("Description",s),1e8<o[d].size&&c(o[d].size,o[d].name);u.showLoader($("#fileList")),$.ajax({type:"POST",url:a,contentType:!1,processData:!1,data:l,success:function(e){0==e.success?(u.hideLoader(fileListContainer),c(e.fileSize,e.fileName)):$.ajax({type:"Get",url:"/FileStore/List?EntityId="+i+"&amp;EntityName="+n,success:function(e){var t=$("#fileList");if(t)return $(t).html(e),u.manageContentReload($(t)),u.hideLoader(t),!0}})}}),$(t).trigger("reset"),$(".content-upload-filename").html(""),$("#Description").removeClass("not-empty").addClass("empty")},$(document).on("submit",".form-file-upload",function(e){e.preventDefault(),u.uploadFile($(this))}),t.on("resize",function(){clearTimeout(e),e=setTimeout(function(){o=u.calculateWindowHeight(),u.calculateWindowWidth(),u.manageAside(),u.showHideFooter(),u.manageGridContent(),u.updateNiceScroll(),u.manageDetailesContent(),u.findGrids()},66)}),$(document).ready(function(){o=u.calculateWindowHeight(),u.calculateWindowWidth(),u.getBreadCrumbsList(breadCrumbCookie),u.checkCollapsedBody(),u.findValidateForm(s),u.showHideFooter(),u.manageContentTabs(),u.initMask(s),u.findFormatDateParagraph(s),u.activateFormControls(s),u.manageAside(),u.initAllInputTextareaAfterLoad(),u.onLoadCheckAllInputs(),u.updateNiceScroll(),u.manageDetailesContent(),u.scrollTop()}),document.addEventListener("change",function(e){}),this.goStepBack=function(){window.history.go(-1)}},mt=new MainTemplates;