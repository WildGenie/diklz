describe('load_cert', function () {
    it('key with cert included is loaded from binary data', function (done) {
        var lib = new UacPlugin("http://cala.it-engineering.com.ua/service/");
        var fileKeyData = "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";
        var filePass = "QAZwsx12";
        var fileName = "pb_2880405538.jks";

        // function to be tested
        lib.loadKeyStore(
            { data: fileKeyData, name: fileName },
            window.btoa(filePass),
            onSuccess,
            errorHandler
        );

        function onSuccess(store) {
            expect(true).toBe(true); // test passed
            done();
        };

        function errorHandler(err, obj) {
            expect(true).toBe(false); // test failed
            done();
        };
    });

    it('key and cert are loaded separately from binary data', function (done) {
        var lib = new UacPlugin("http://cala.it-engineering.com.ua/service/");
        var fileKeyData = "MIIDxAIBAzCCA2EGCSqGSIb3DQEHAaCCA1IEggNOMIIDSjCCAZUGCSqGSIb3DQEHAaCCAYYEggGCMIIBfjCCAXoGCyqGSIb3DQEMCgECoIIBNjCCATIwgbMGCSqGSIb3DQEFDTCBpTBGBgkqhkiG9w0BBQwwOQQg+YlRANT9v7jC+MeU/PeNO8xJxJ20aFI0w6+YSDzE4UcCAgPoAgEgMA4GCiqGJAIBAQEBAQIFADBbBgsqhiQCAQEBAQEBAzBMBAi1o52kk7FMogRAqdbrRfE8cIKAxJZ7Ix9erfZY66TANykdONlr8CXKThf46XINxhW0OiiXXwvB3qNkOLVk6iwXn9ASPm24+sV5BAR65O//0L6O9lGwYIkzRfubNMaKUii66lQbVoyrNqAYdAHnkKfgMxrRWIZzsDOA3Wd+dQovUAHzQsZD5hU3sbUCYS6aJHaxJfuLoNEbIHT351pQ14JVhjN7DMlDo5/dJi3y0m10eVM740vW0G33u5UYrJLZpNHZ7+oDiv8xMTAvBgkqhkiG9w0BCRUxIgQgK6GeqfCHTnRRjbMYjHWujOUzlQ4+72U9NxmL7zBj4QYwggGtBgkqhkiG9w0BBwGgggGeBIIBmjCCAZYwggGSBgsqhkiG9w0BDAoBAqCCAU4wggFKMIGzBgkqhkiG9w0BBQ0wgaUwRgYJKoZIhvcNAQUMMDkEIEMBWPivR6E2KDcdJuGGnJ0ZNkZ7YxQJ01uDEQpyLsKXAgID6AIBIDAOBgoqhiQCAQEBAQECBQAwWwYLKoYkAgEBAQEBAQMwTAQIZmRKftjI1CkEQKnW60XxPHCCgMSWeyMfXq32WOukwDcpHTjZa/Alyk4X+OlyDcYVtDool18Lwd6jZDi1ZOosF5/QEj5tuPrFeQQEgZEZl+AmRTBEMRdMsj84c5k3UufKpiR/oZnsICBg/qy6TzTzXlyyXGTj5tZw5j5KgYSblua9XwNxqVlRiF7Uo7g+0puVqWSRny8Ito3OfjTsicxOKs1kKyttdoi/fgXNsYbS8zlg8mUw875w56Ue5gw77YV/nMkZ6qRk/y83NQXAqcbwYo7MDvxf+cSJAXxUe4uEMTEwLwYJKoZIhvcNAQkVMSIEINK+M7Y31RgbU1dGXfmt+uj3uTeKJJyQkeCwCcuoH2F6MFowMjAOBgoqhiQCAQEBAQIBBQAEIK+YeEFdY6gXeooDU0EtTurysmNcOcWT0ImiO0RhYfLdBCDDAzJQwoFIFdD87Z2+H1R/F/UCL+V/6dQsIGHHWh9CIAICA+g=";
        var filePass = "111";
        var fileName = "87654321_87654321_DU180904160002.ZS2";
        var certName1 = "cl_0100000000000000000000000000000006e40b12.crt";
        var certData1 = "MIIFKjCCBNKgAwIBAgIUEgvkBgAAAAAAAAAAAAAAAAAAAAEwDQYLKoYkAgEBAQEDAQEwggEcMVswWQYDVQQDDFLQkNCm0KHQmiDQotCe0JIgItCm0LXQvdGC0YAg0YHQtdGA0YLQuNGE0ZbQutCw0YbRltGXINC60LvRjtGH0ZbQsiAi0KPQutGA0LDRl9C90LAiMREwDwYDVQQHDAjQmtC40ZfQsjEZMBcGA1UEBQwQVUEtMzY4NjU3NTMtMDExNzFSMFAGA1UECgxJ0KLQntCSICLQptC10L3RgtGAINGB0LXRgNGC0LjRhNGW0LrQsNGG0ZbRlyDQutC70Y7Rh9GW0LIgItCj0LrRgNCw0ZfQvdCwIjEuMCwGA1UECwwl0JLRltC00LTRltC7INGB0LXRgNGC0LjRhNGW0LrQsNGG0ZbRlzELMAkGA1UEBgwCVUEwHhcNMTgwOTA0MTMwNzQ5WhcNMjAwOTAzMjA1OTU5WjCB5zEvMC0GA1UEAwwm0KLQtdGB0YIg0KLQtdGB0YLQvtCyINCi0LXRgdGC0L7QstC40YcxETAPBgNVBAcMCNCa0JjQh9CSMQ4wDAYDVQQRDAUwMTAwMTEZMBcGA1UEDAwQ0JrQtdGA0ZbQstC90LjQujERMA8GA1UEBAwI0KLQtdGB0YIxJjAkBgNVBCoMHdCi0LXRgdGC0L7QsiDQotC10YHRgtC+0LLQuNGHMRIwEAYDVQQFDAk4NzY1NDMyMUQxGjAYBgNVBAoMEdCi0J7QkiAi0KLQtdGB0YIiMQswCQYDVQQGDAJVQTBGMB4GCyqGJAIBAQEBAwEBMA8GDSqGJAIBAQEBAwEBAgYDJAAEIUc1rvGYJ3e84NFQGaX0Ga7w5aiSWfab+jGGyntZmzkIAaOCAjIwggIuMEEGA1UdCQQ6MDgwGgYMKoYkAgEBAQsBBAIBMQoTCDg3NjU0MzIxMBoGDCqGJAIBAQELAQQBATEKEwg4NzY1NDMyMTAaBgNVHREEEzARgQ9hY3NrQG1pbi5nb3YudWEwKQYDVR0OBCIEICuhnqnwh050UY2zGIx1rozlM5UOPu9lPTcZi+8wY+EGMCsGA1UdIwQkMCKAIJTGV3dyTasMIotrbbod3WJeB3bvWpFKyeW4w3SyexheMA4GA1UdDwEB/wQEAwIAwDAYBgNVHSUEETAPBg0qhiQCAQEBC5HKjVkBMBkGA1UdIAEB/wQPMA0wCwYJKoYkAgEBAQICMB4GCCsGAQUFBwEDAQH/BA8wDTALBgkqhiQCAQEBAgEwMwYDVR0uBCwwKjAooCagJIYiaHR0cDovL3Vha2V5LmNvbS51YS9saXN0LWRlbHRhLmNybDAtBgNVHR8EJjAkMCKgIKAehhxodHRwOi8vdWFrZXkuY29tLnVhL2xpc3QuY3JsMD0GCCsGAQUFBwELBDEwLzAtBggrBgEFBQcwA4YhaHR0cDovL3Vha2V5LmNvbS51YS9zZXJ2aWNlcy90c3AvMG0GCCsGAQUFBwEBBGEwXzAtBggrBgEFBQcwAoYhaHR0cDovL3Vha2V5LmNvbS51YS91YWtleWNlcnQucDdiMC4GCCsGAQUFBzABhiJodHRwOi8vdWFrZXkuY29tLnVhL3NlcnZpY2VzL29jc3AvMA0GCyqGJAIBAQEBAwEBA0MABECUxUbSmcDyzJtvy1zzgnpZUmZAXR2CaF37mjfWPhyjQoAv9WBEbS0e/JFMl/EMIE+GZ/0rx1Hzi77qwKz4bnxU";
        var certName2 = "cl_0100000000000000000000000000000006e40b13.crt";
        var certData2 = "MIIFPzCCBOegAwIBAgIUEwvkBgAAAAAAAAAAAAAAAAAAAAEwDQYLKoYkAgEBAQEDAQEwggEcMVswWQYDVQQDDFLQkNCm0KHQmiDQotCe0JIgItCm0LXQvdGC0YAg0YHQtdGA0YLQuNGE0ZbQutCw0YbRltGXINC60LvRjtGH0ZbQsiAi0KPQutGA0LDRl9C90LAiMREwDwYDVQQHDAjQmtC40ZfQsjEZMBcGA1UEBQwQVUEtMzY4NjU3NTMtMDExNzFSMFAGA1UECgxJ0KLQntCSICLQptC10L3RgtGAINGB0LXRgNGC0LjRhNGW0LrQsNGG0ZbRlyDQutC70Y7Rh9GW0LIgItCj0LrRgNCw0ZfQvdCwIjEuMCwGA1UECwwl0JLRltC00LTRltC7INGB0LXRgNGC0LjRhNGW0LrQsNGG0ZbRlzELMAkGA1UEBgwCVUEwHhcNMTgwOTA0MTMwNzUwWhcNMjAwOTAzMjA1OTU5WjCB5zEvMC0GA1UEAwwm0KLQtdGB0YIg0KLQtdGB0YLQvtCyINCi0LXRgdGC0L7QstC40YcxETAPBgNVBAcMCNCa0JjQh9CSMQ4wDAYDVQQRDAUwMTAwMTEZMBcGA1UEDAwQ0JrQtdGA0ZbQstC90LjQujERMA8GA1UEBAwI0KLQtdGB0YIxJjAkBgNVBCoMHdCi0LXRgdGC0L7QsiDQotC10YHRgtC+0LLQuNGHMRIwEAYDVQQFDAk4NzY1NDMyMUQxGjAYBgNVBAoMEdCi0J7QkiAi0KLQtdGB0YIiMQswCQYDVQQGDAJVQTBbMB4GCyqGJAIBAQEBAwEBMA8GDSqGJAIBAQEBAwEBAgkDOQAENsnCzsg8qJCbylWaYmtnHfRNg30pK3p9Y2KOcaeyJaFpDFRCJM2rqIhPhxw2mGjJEl90UzUeXqOCAjIwggIuMEEGA1UdCQQ6MDgwGgYMKoYkAgEBAQsBBAIBMQoTCDg3NjU0MzIxMBoGDCqGJAIBAQELAQQBATEKEwg4NzY1NDMyMTAaBgNVHREEEzARgQ9hY3NrQG1pbi5nb3YudWEwKQYDVR0OBCIEINK+M7Y31RgbU1dGXfmt+uj3uTeKJJyQkeCwCcuoH2F6MCsGA1UdIwQkMCKAIJTGV3dyTasMIotrbbod3WJeB3bvWpFKyeW4w3SyexheMA4GA1UdDwEB/wQEAwIACDAYBgNVHSUEETAPBg0qhiQCAQEBC5HKjVkBMBkGA1UdIAEB/wQPMA0wCwYJKoYkAgEBAQICMB4GCCsGAQUFBwEDAQH/BA8wDTALBgkqhiQCAQEBAgEwMwYDVR0uBCwwKjAooCagJIYiaHR0cDovL3Vha2V5LmNvbS51YS9saXN0LWRlbHRhLmNybDAtBgNVHR8EJjAkMCKgIKAehhxodHRwOi8vdWFrZXkuY29tLnVhL2xpc3QuY3JsMD0GCCsGAQUFBwELBDEwLzAtBggrBgEFBQcwA4YhaHR0cDovL3Vha2V5LmNvbS51YS9zZXJ2aWNlcy90c3AvMG0GCCsGAQUFBwEBBGEwXzAtBggrBgEFBQcwAoYhaHR0cDovL3Vha2V5LmNvbS51YS91YWtleWNlcnQucDdiMC4GCCsGAQUFBzABhiJodHRwOi8vdWFrZXkuY29tLnVhL3NlcnZpY2VzL29jc3AvMA0GCyqGJAIBAQEBAwEBA0MABEC3deh8sIe67Em8w2aopBy6Li6aSnDeiSZ4xanGYhojDQVoLpwY4/iic7OPK99U5UnIE37ZzeMgMFvnyEfsVYRR";
        var certSaveAll = true;
        var keyStore;

        // function to be tested
        lib.loadKeyStore(
            { data: fileKeyData, name: fileName },
            window.btoa(filePass),
            onLoadKeySuccess,
            errorHandler
        );

        function onLoadKeySuccess(store) {
            keyStore = store;
            var certs = [];

            var info1 = lib.loadCert(certData1);
            if (info1) {
                certs.push(info1);
            };

            var info2 = lib.loadCert(certData2);
            if (info2) {
                certs.push(info2);
            };
            // function to be tested
            lib.keyStoreAddCerts(keyStore, certs, certSaveAll,
                onLoadCertSuccess,
                errorHandler
            );
        };

        function onLoadCertSuccess(store, changesQty) {
            if (changesQty) {
                keyStore = store;
                expect(true).toBe(true); // test passed
            } else {
                expect(true).toBe(false); // test failed    
            }
            
            done();
        }

        function errorHandler(err, obj) {
            expect(true).toBe(false); // test failed
            done();
        };
    });

});